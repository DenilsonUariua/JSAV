/*!
 * JSAV - JavaScript Algorithm Visualization Library
 * Version v0.7.0-258-g9416b99
 * Copyright (c) 2011-2014 by Ville Karavirta and Cliff Shaffer
 * Released under the MIT license.
 */
if(function(a){"use strict";function b(b,c){for(var e=d.init.functions,f=0;f<e.length;f++)a.isFunction(e[f])&&e[f].call(b,c)}function c(a,b,d){for(var e in d)if(d.hasOwnProperty(e)&&!(e in b))switch(typeof d[e]){case"function":!function(c){b[e]=b===a?c:function(){return c.apply(a,arguments)}}(d[e]);break;case"object":b[e]=b[e]||{},c(a,b[e],d[e]);break;default:b[e]=d[e]}}var d=function(){f.apply(this,arguments)};d.position=function(b){var c=a(b),d=c.position(),e=null;return e?{left:d.left+e[0],top:d.top+e[1]}:d};var e=d.prototype;e.getSvg=function(){if(!this.svg){this.svg=Raphael(this.canvas[0]);var a=this.svg.canvas.style;a.position="absolute"}return this.svg},e.id=function(){var a=this.container[0].id;return a||(a=d.utils.createUUID(),this.container[0].id=a),a},d._types={},d.ext={},d.init=function(a){d.init.functions.push(a)},d.init.functions=[];var f=function(){"string"==typeof arguments[0]?this.container=a(document.getElementById(arguments[0])):arguments[0]instanceof HTMLElement?this.container=a(arguments[0]):arguments[0]&&"object"==typeof arguments[0]&&arguments[0].constructor===jQuery&&(this.container=arguments[0]),this.container?this.options=a.extend({autoresize:!0},window.JSAV_OPTIONS,arguments[1]):(this.options=a.extend({autoresize:!0},window.JSAV_OPTIONS,arguments[0]),this.container=a(this.options.element));var e=this.container.clone().wrap("<p/>").parent().html();this.container.addClass("jsavcontainer"),this.canvas=this.container.find(".jsavcanvas"),0===this.canvas.size()&&(this.canvas=a("<div />").addClass("jsavcanvas").appendTo(this.container));var f=a("<div class='jsavshutter' />").appendTo(this.container);this._shutter=f,this.RECORD=!0,jQuery.fx.off=!0,b(this,this.options),c(this,this,d.ext),this.logEvent({type:"jsav-init",initialHTML:e})};d.init(function(){if(this.options.autoresize){var b=this;this.container.on("jsav-updaterelative",function(){var c=parseInt(b.canvas.css("minHeight"),10),d=parseInt(b.canvas.css("minWidth"),10);if(b.canvas.children().each(function(b,e){var f=a(e),g=f.position();"svg"!==e.nodeName.toLowerCase()&&(c=Math.max(c,g.top+f.innerHeight()),d=Math.max(d,g.left+f.innerWidth()))}),b.svg)for(var e,f,g=b.svg.bottom;g;)e=g.getBBox(),f=g.attr("stroke-width"),c=Math.max(c,e.y2+f),d=Math.max(d,e.x2+f),g=g.next;b.canvas.css({minHeight:c,minWidth:d})})}}),window&&(window.JSAV=d)}(jQuery),function(){"use strict";"undefined"!=typeof JSAV&&(JSAV._translations={en:{backwardButtonTitle:"Backward",forwardButtonTitle:"Forward",beginButtonTitle:"Begin",endButtonTitle:"End",resetButtonTitle:"Reset",undoButtonTitle:"Undo",modelButtonTitle:"Model Answer",gradeButtonTitle:"Grade",modelWindowTitle:"Model Answer",feedbackLabel:"Grading Mode: ",continuous:"Continuous",atend:"At end",fixLabel:"Continuous feedback behaviour",undo:"Undo incorrect step",fix:"Fix incorrect step",scoreLabel:"Score:",remainingLabel:"Points remaining:",lostLabel:"Points lost:",doneLabel:"DONE",yourScore:"Your score:",fixedSteps:"Fixed incorrect steps:",fixedPopup:"Your last step was incorrect. Your work has been replaced with the correct step so that you can continue.",fixFailedPopup:"Your last step was incorrect and I should fix your solution, but don't know how. So it was undone and you can try again.",undonePopup:"Your last step was incorrect. Things are reset to the beginning of the step so that you can try again.",settings:"Settings",animationSpeed:"Animation speed","(slowFast)":"(slow - fast)",valueBetween1And10:"Value between 1 (Slow) and 10 (Fast).",save:"Save",saved:"Saved...",questionClose:"Close",questionCheck:"Check Answer",questionCorrect:"Correct!",questionIncorrect:"Incorrect"},fi:{backwardButtonTitle:"Askel taaksepäin",forwardButtonTitle:"Askel eteenpäin",beginButtonTitle:"Kelaa alkuun",endButtonTitle:"Kelaa loppuun",resetButtonTitle:"Uudelleen",undoButtonTitle:"Kumoa",modelButtonTitle:"Mallivastaus",gradeButtonTitle:"Arvostele",modelWindowTitle:"Mallivastaus",feedbackLabel:"Arvostelumuoto: ",continuous:"Jatkuva",atend:"Lopussa",fixLabel:"Jatkuvan arvostelun asetukset",undo:"Kumoa väärin menneet askeleet",fix:"Korjaa väärin menneet askeleet",scoreLabel:"Pisteet:",remainingLabel:"Pisteitä jäljellä:",lostLabel:"Menetetyt pisteet:",doneLabel:"VALMIS",yourScore:"Sinun pisteesi:",fixedSteps:"Korjatut askeleet:",fixedPopup:"Viime askeleesi meni väärin. Se on korjattu puolestasi, niin että voit jatkaa tehtävää.",fixFailedPopup:"Viime askeleesi meni väärin ja minun tulisi korjata se. En kuitenkaan osaa korjata sitä, joten olen vain kumonnut sen.",undonePopup:"Viime askeleesi meni väärin. Askel on kumottu, niin että voit yrittää uudelleen.",settings:"Asetukset",animationSpeed:"Animointinopeus","(slowFast)":"(hidas - nopea)",valueBetween1And10:"Anna arvo 1:n (hidas) ja 10:n (nopea) välillä.",save:"Tallenna",saved:"Tallennettu...",questionClose:"Sulje",questionCheck:"Tarkista vastaus",questionCorrect:"Oikein!",questionIncorrect:"Väärin"},sv:{resetButtonTitle:"Börja om",undoButtonTitle:"Ångra",modelButtonTitle:"Visa lösning",gradeButtonTitle:"Poängsätt",modelWindowTitle:"Lösning",feedbackLabel:"Rättningsalternativ: ",continuous:"Rätta kontinuerligt",atend:"Poängsätt i slutet",fixLabel:"Alternativ för kontinuerlig rättning",undo:"Ångra felaktigt steg",fix:"Åtgärda felaktigt steg",scoreLabel:"Poäng:",remainingLabel:"Kvarvarande poäng:",lostLabel:"Förlorade poäng:",doneLabel:"FÄRDIG!",yourScore:"Din poäng:",fixedSteps:"Åtgärdade felaktiga steg:",fixedPopup:"Ditt senaste steg var felaktigt. Det har ersatts med det korrekta steget så att du kan fortsätta.",fixFailedPopup:"Ditt senaste steg var felaktigt men jag vet inte hur det bör åtgärdas. Därför har ditt steg ångrats och du kan försöka igen.",undonePopup:"Ditt senaste steg var felaktigt. Steget har ångrats så att du kan försöka igen.",settings:"Inställningar",animationSpeed:"Animationshastighet","(slowFast)":"(långsamt - snabbt)",valueBetween1And10:"Värde mellan 1 (långsamt) och 10 (snabbt).",save:"Spara",saved:"Sparat..."},fr:{resetButtonTitle:"Reinitialiser",undoButtonTitle:"Annuler",modelButtonTitle:"Solution",gradeButtonTitle:"Score",modelWindowTitle:"Solution",feedbackLabel:"Type de controle: ",continuous:"Continue",atend:"A la fin",fixLabel:"Parametres de controle continue",undo:"Annuler les étapes incorrectes",fix:"Corriger les étapes incorrectes",scoreLabel:"Score:",remainingLabel:"Points restants:",lostLabel:"Points perdus:",doneLabel:"Activite terminée",yourScore:"Votre score:",fixedSteps:"Corriger les étapes incorrectes:",fixedPopup:"Votre dernière action etait incorrecte. Votre action a été corrigée pour vous permettre de poursuivre.",fixFailedPopup:"Votre dernière action etait incorrecte et je ne sais pas comment la corriger. Votre action a ete annulée, essayez a nouveau.",undonePopup:"Votre dernière action etait incorrecte. La simulation a été reinitialisée. Essayez a nouveau.",settings:"Paramètres",animationSpeed:"Vitesse","(slowFast)":"(lent - rapide)",valueBetween1And10:"Vitesse entre 1 (Lent) et 10 (Rapide).",save:"Sauvegarder",saved:"Sauvegarde complète..."}},JSAV.init(function(a){var b=a.lang||"en";this._translate="object"==typeof JSAV._translations[b]?JSAV.utils.getInterpreter(JSAV._translations,b):JSAV.utils.getInterpreter(JSAV._translations,"en")}))}(jQuery),function(a){"use strict";function b(b){if(0!==this._undo.length){for(var c=this._undo.pop(),d=c.operations,e=d.length-1;e>=0;e--){var f=d[e];f.undo()}return this._redo.unshift(c),b&&a.isFunction(b)&&!b(c)&&this.backward(b),this.container.trigger("jsav-updatecounter",[this.currentStep()+1,this.totalSteps()+1]),c}}function c(){if(0!==this._redo.length){for(var a=this._redo.shift(),b=a.operations,c=0;c<b.length;c++){var d=b[c];d.apply()}return this._undo.push(a),this.container.trigger("jsav-updatecounter",[this.currentStep()+1,this.totalSteps()+1]),a}}function d(){var b=a.fx.off||!1;for(a.fx.off=!0;this._undo.length;)this.backward();return a.fx.off=b,this}function e(){var b=a.fx.off||!1;for(a.fx.off=!0;this._redo.length;)this.forward();return a.fx.off=b,this}function f(b,c){return function(){var d=this,e=a.makeArray(arguments),f=!1;if(e.length>0&&e[e.length-1]&&"object"==typeof e[e.length-1]&&e[e.length-1].record===!1&&(f=!0),d.hasOwnProperty("_redo")||(d=this.jsav),"none"===d.options.animationMode||f)b.apply(this,arguments);else{var g=d._undo[d._undo.length-1];g||(g=new k,d._undo.push(g));var h=new j({obj:this,effect:b,args:arguments,undo:c});g.add(h),d._shouldAnimate()&&d.container.addClass(i),h.apply(),d._shouldAnimate()&&d._clearPlaying()}return this}}function g(b,c){var d=this.currentStep(),e=b.call(this);if(!e)return!1;if(c&&a.isFunction(c)){for(var f=c(e),g=f;!f&&this.currentStep()<this.totalSteps()&&(e=b.call(this));)f=c(e),g=g||f;if(!g)return this.jumpToStep(d),!1}return!0}var h=300,i="jsavplaying";if("undefined"!=typeof JSAV){var j=function(a){this.obj=a.obj,this.effect=a.effect,this.args=a.args,a.undo&&(this.undoeffect=a.undo),a.undoargs&&(this.undoArgs=a.undoargs)};j.prototype.apply=function(){var b=this,c=b.obj,d=c.state?c.state():null,e=this.effect.apply(this.obj,this.args);"undefined"==typeof e||e===this.obj?"undefined"!=typeof this.undoeffect&&a.isFunction(this.undoeffect)||(this.undoeffect=function(){return function(){c.state(d)}}()):this.undoArgs=e},j.prototype.undo=function(){"undefined"==typeof this.undoArgs?this.undoeffect.apply(this.obj,this.args):this.effect.apply(this.obj,this.undoArgs)};var k=function(a){this.operations=[],this.options=a||{}};if(k.prototype.add=function(a){this.operations.push(a)},k.prototype.isEmpty=function(){return 0===this.operations.length},JSAV.init(function(){function b(a){var b={type:a,currentStep:d.currentStep(),totalSteps:d.totalSteps()};d.logEvent(b)}function c(b,c){var d,e=function(){b.isAnimating()||(b.container.removeClass(i),b._animations=0,a.isFunction(c)&&c(),clearInterval(d))};d=setInterval(e,50)}this._animations=0,this._redo=[],this._undo=[];var d=this,e=a(".jsavcontrols",this.container);this._clearPlaying=function(b){this.isAnimating()?c(this,b):(this.container.removeClass(i),a.isFunction(b)&&b())};var f=function(a){a.preventDefault(),a.stopPropagation(),d.container.hasClass(i)||(d.container.addClass(i),d.begin(),d._clearPlaying(),b("jsav-begin"))},g=function(a,c){a.preventDefault(),a.stopPropagation(),a.stopPropagation(),d.container.hasClass(i)||(d.container.addClass(i),d.backward(c),d._clearPlaying(),b("jsav-backward"))},h=function(a,c){a.preventDefault(),a.stopPropagation(),d.container.hasClass(i)||(d.container.addClass(i),d.forward(c),d._clearPlaying(),b("jsav-forward"))},j=function(a){a.preventDefault(),a.stopPropagation(),d.container.hasClass(i)||(d.container.addClass(i),d.end(),d._clearPlaying(),b("jsav-end"))};if(0!==e.size()){var k=this._translate("beginButtonTitle");a("<span class='jsavbegin' title='"+k+"'>"+k+"</span>").click(f).appendTo(e),k=this._translate("backwardButtonTitle"),a("<span class='jsavbackward' title='"+k+"'>"+k+"</span>").click(g).appendTo(e),k=this._translate("forwardButtonTitle"),a("<span class='jsavforward' title='"+k+"'>"+k+"</span>").click(h).appendTo(e),k=this._translate("endButtonTitle"),a("<span class='jsavend' title='"+k+"'>"+k+"</span>").click(j).appendTo(e),this._controlsContainer=e}this.container.bind({"jsav-forward":h,"jsav-backward":g,"jsav-begin":f,"jsav-end":j});var l=a(".jsavcounter",this.container);l.size()>0&&(l.text("0 / 0"),this.container.bind("jsav-updatecounter",function(a,b,c){l.text(b+" / "+c)})),a(document).bind("jsav-speed-change",function(a,b){d.SPEED=b})}),JSAV.anim=f,localStorage){var l=localStorage.getItem("jsav-speed");l?(l=parseInt(l,10),isNaN(l)&&(l=h)):l=h,JSAV.ext.SPEED=l}else JSAV.ext.SPEED=h;JSAV.ext.begin=d,JSAV.ext.end=e,JSAV.ext.forward=function(a){return g.call(this,c,a)},JSAV.ext.backward=function(a){return g.call(this,b,a)},JSAV.ext.currentStep=function(){return this._undo.length},JSAV.ext.totalSteps=function(){return this._undo.length+this._redo.length},JSAV.ext.animInfo=function(){var a,b={steps:this.totalSteps()},c=0;for(a=this._undo.length;a--;)c+=this._undo[a].operations.length;for(a=this._redo.length;a--;)c+=this._redo[a].operations.length;return b.effects=c,b},JSAV.ext.step=function(a){return this.container.trigger("jsav-updaterelative"),this._undo.push(new k(a)),a&&this.message&&a.message&&this.message(a.message),this},JSAV.ext.clear=function(b){var c=a.extend({undo:!0,redo:!0},b);c.undo&&(this._undo=[]),c.redo&&(this._redo=[])},JSAV.ext.displayInit=function(){return this.container.trigger("jsav-updaterelative"),this.clear({redo:!1}),this},JSAV.ext.jumpToStep=function(b){var c=this.totalSteps(),d=this,e=function(){return d.currentStep()===b},f=a.fx.off||!1;return a.fx.off=!0,b>=c?this.end():0>b?this.begin():b<this.currentStep()?this.backward(e):this.forward(e),a.fx.off=f,this},JSAV.ext.stepOption=function(a,b){var c=this._undo[this._undo.length-1];if(void 0!==b)c&&(c.options[a]=b);else{if("string"==typeof a)return c?c.options[a]:void 0;for(var d in a)a.hasOwnProperty(d)&&this.stepOption(d,a[d])}},JSAV.ext.recorded=function(){return this._undo.length>1&&this._undo[this._undo.length-1].isEmpty()?this._undo.pop():this.container.trigger("jsav-updaterelative"),this.begin(),this.RECORD=!1,a.fx.off=!1,this.logEvent({type:"jsav-recorded"}),this},JSAV.ext.isAnimating=function(){return!!this.container.find(":animated").size()||this._animations>0},JSAV.ext._shouldAnimate=function(){return!this.RECORD&&!a.fx.off&&this.SPEED>50},JSAV.ext.disableControls=function(){this._controlsContainer&&this._controlsContainer.addClass("jsavdisabled")},JSAV.ext.enableControls=function(){this._controlsContainer&&this._controlsContainer.removeClass("jsavdisabled")}}}(jQuery),jQuery.cssHooks.borderColor={get:function(a){return jQuery(a).css("border-top-color")}},jQuery.cssHooks.borderWidth={get:function(a){return jQuery(a).css("border-top-width")}},function(a){"use strict";if("undefined"!=typeof JSAV){var b=a("<input type='range' />");a.support.inputTypeRange="range"===b.prop("type");var c=function(){},d=c.prototype;d.id=function(a){if(a)return this.element[0].id=a,this;var b=this.element[0].id;return b||(b=JSAV.utils.createUUID(),this.element[0].id=b),b},d.bounds=function(b,c){if(b&&a.isFunction(this.layout))return this.layout(a.extend({boundsOnly:!0},c));var d=this.position();return a.extend({width:this.element.width(),height:this.element.height()},d)},d.position=function(){return JSAV.position(this.element)},d.isVisible=function(){return this.element.filter(":visible").size()>0},d.clear=function(){this.element&&this.element.remove()},d._animateTranslate=JSAV.anim(function(a,b,c){var d="auto"===this.element.css("left")?a:"+="+a,e="auto"===this.element.css("top")?b:"+="+b;return this.element.css({left:d+"px",top:e+"px"}),this.jsav._shouldAnimate()&&(this.element.css({x:-a,y:-b,z:1}),this.jsav.effects.transition(this.element,{x:0,y:0,z:1},c)),[-a,-b,c]}),d.translate=function(a,b,c){var d=this._animateTranslate(a,b,c);return this._moveListeners&&this.element.trigger("jsav-object-move",[a,b]),d},d.translateX=function(a,b){return this.translate(a,0,b)},d.translateY=function(a,b){return this.translate(0,a,b)},d.moveTo=function(a,b,c){{var d=this.element.position(),e=a-d.left,f=b-d.top;this._animateTranslate(e,f,c)}this._moveListeners&&this.element.trigger("jsav-object-move",[e,f])},d._registerMoveListener=function(b){a.isFunction(b)&&(this._moveListeners=(this._moveListeners||0)+1,this.element.on("jsav-object-move",b),this.container&&this.container._registerMoveListener(b))},d._unregisterMoveListener=function(a){this.element.off("jsav-object-move",a),this._moveListeners--,this.container&&this.container._unregisterMoveListener(a)},JSAV._types.JSAVObject=c,JSAV.utils={};var e=JSAV.utils;e.getQueryParameter=function(a){var b,c,d=window.location.search,e={};if(d)for(d=d.slice(1).split("&"),b=d.length;b--;)if(c=d[b].split("="),e[c[0]]=decodeURIComponent(c[1]),a&&c[0]===a)return c[1];if(!a)return e},e.createUUID=function(){for(var a=[],b=0;32>b;b++)a[b]=(~~(16*Math.random())).toString(16);return a[12]=4,a[16]=(3&a[16]|8).toString(16),"jsav-"+a.join("")},e.iterable=function(a){var b=0,c=a.slice(0);return c.next=function(){return this[b++]},c.hasNext=function(){return b<this.length},c.reset=function(){b=0},c},e.isGraphicalPrimitive=function(a){return a?!!a.rObj:!1},JSAV.ext.logEvent=function(b){"object"==typeof b&&(b.hasOwnProperty("tstamp")||(b.tstamp=(new Date).toISOString()),b.hasOwnProperty("av")||(b.av=this.id()),b.currentStep=this.currentStep()),a.isFunction(this.options.logEvent)?this.options.logEvent(b):a("body").trigger("jsav-log-event",[b])};var f='<div class="jsavdialog"></div>',g=null;e.dialog=function(b,c){c=a.extend({},{modal:!0,closeOnClick:!0},c);var d,e,h,i=c.modal,j=a(c.dialogBase||f),k=["width","height","minWidth","minHeight","maxWidth","maxHeight"];"string"==typeof b?j.html(b):a.isFunction(b)?j.html(b()):j.append(b),"title"in c&&j.prepend("<h2>"+c.title+"<a href='#' class='jsavdialogclose'>X</a></h2>"),"dialogClass"in c&&j.addClass(c.dialogClass);for(d=0,e=k.length;e>d;d++)h=k[d],void 0!==c[h]&&j.css(h,c[h]);var l=a(document),m=a(window),n=l.height(),o=l.width(),p=m.height(),q=m.width(),r=l.scrollLeft(),s=l.scrollTop();"width"in c||j.css("width",Math.max(500,.7*q));var t=function(b){b&&b.preventDefault(),g&&g.detach(),j.remove(),a.isFunction(c.closeCallback)&&c.closeCallback()};if(i&&(g=g||a('<div class="jsavmodal" />'),g.css({width:o,height:n}),g.appendTo(a("body")),c.closeOnClick&&g.click(t)),j.find(".jsavdialogclose").click(t),"closeText"in c){var u=a('<button type="button" class="jsavrow">'+c.closeText+"</button>").click(t);j.append(u)}var v=j.appendTo(c.dialogRootElement||a("body")).add(g);v.draggable();var w=function(){j.css({top:Math.max(s+(p-j.outerHeight())/2,0),left:r+(q-j.outerWidth())/2})};return w(),v.show=function(){w(),v.fadeIn()},v.close=t,v},e.value2type=function(a,b){return"number"===b?Number(a):"boolean"===b?"boolean"==typeof a?a:"string"==typeof a?"true"===a:!!a:a};var h=function(){return!0};e.rand={random:Math.random,numKey:function(a,b){return Math.floor(this.random()*(b-a)+a)},numKeys:function(b,c,d,e){var f,g=a.extend(!0,{sorted:!1,test:h,tries:10},e),i=g.tries,j=d;do for(f=[],j=d;j--;)f.push(this.numKey(b,c));while(i--&&!g.test(f));return g.sorted&&f.sort(g.sortfunc||function(a,b){return a-b}),f},sample:function(b,c,d){var e,f,g,i=a.extend(!0,{test:h,tries:10},d),j=b.length,k=i.tries;if(c>j||0>c)return void 0;do{e=b.slice(0);for(var l=0;c>l;l++)f=e[l],g=this.numKey(l,j),e[l]=e[g],e[g]=f}while(k--&&!i.test(e));return e.slice(0,c)}},e.extend=function(a,b){function c(){}c.prototype=b.prototype;var d=new c;d.constructor=a,a.prototype=d},e.getInterpreter=function(b,c){var d;return"string"==typeof b?(-1!==b.indexOf("{lang}")&&(b=b.replace("{lang}",c),c=void 0),a.ajax({url:b,async:!1,dataType:"json",success:function(a){d=c?a[c]:a}})):"object"==typeof b&&(d=c?b[c]:b),"object"!=typeof d?(console.warn("Language not found ("+c+")"),function(a){return"["+a+"]"}):function(a){return"undefined"==typeof d[a]?(console.warn("Cannot find label: "+a),"["+a+"]"):d[a]}},e.replaceLabels=function(a,b){if(!b||"object"!=typeof b)return a;var c=a;for(var d in b)if(b.hasOwnProperty(d)){var e=new RegExp("{"+d+"}","g");c=c.replace(e,b[d])}return c},e.getUndoableFunction=function(a,b,c){var d=JSAV.anim(b,c);return function(){d.apply(a,arguments)}},/*!
// based on seedrandom.js version 2.0.
// Author: David Bau 4/2/2011
// http://davidbau.com/encode/seedrandom.js
//
// 12/12/2011: Original code modified to add the methods to JSAV.utils.rand
// instead of overwriting the Math.random().
//
// LICENSE (BSD):
//
// Copyright 2010 David Bau, all rights reserved.
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are met:
//
//   1. Redistributions of source code must retain the above copyright
//      notice, this list of conditions and the following disclaimer.
//
//   2. Redistributions in binary form must reproduce the above copyright
//      notice, this list of conditions and the following disclaimer in the
//      documentation and/or other materials provided with the distribution.
//
//   3. Neither the name of this module nor the names of its contributors may
//      be used to endorse or promote products derived from this software
//      without specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
// "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
// LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
// A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
// OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
// SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
// LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
// DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
// THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/
function(a,b,c,d,e,f,g){function h(a){var b,d,e=this,f=a.length,g=0,h=e.i=e.j=e.m=0;for(e.S=[],e.c=[],f||(a=[f++]);c>g;)e.S[g]=g++;for(g=0;c>g;g++)b=e.S[g],h=k(h+b+a[g%f]),d=e.S[h],e.S[g]=d,e.S[h]=b;e.g=function(a){var b=e.S,d=k(e.i+1),f=b[d],g=k(e.j+f),h=b[g];b[d]=h,b[g]=f;for(var i=b[k(f+h)];--a;)d=k(d+1),f=b[d],g=k(g+f),h=b[g],b[d]=h,b[g]=f,i=i*c+b[k(f+h)];return e.i=d,e.j=g,i},e.g(c)}function i(a,b,c,d,e){if(c=[],e=typeof a,b&&"object"==e)for(d in a)if(d.indexOf("S")<5)try{c.push(i(a[d],b-1))}catch(f){}return c.length?c:a+("string"!=e?"\x00":"")}function j(a,b,c,d){for(a+="",c=0,d=0;d<a.length;d++)b[k(d)]=k((c^=19*b[k(d)])+a.charCodeAt(d));a="";for(d in b)a+=String.fromCharCode(b[d]);return a}function k(a){return a&c-1}b.seedrandom=function(k,l){var m,n=[];return k=j(i(l?[k,a]:arguments.length?k:[(new Date).getTime(),a,window],3),n),m=new h(n),j(m.S,a),b.random=function(){for(var a=m.g(d),b=g,h=0;e>a;)a=(a+h)*c,b*=c,h=m.g(1);for(;a>=f;)a/=2,b/=2,h>>>=1;return(a+h)/b},k},g=Math.pow(c,d),e=Math.pow(2,e),f=2*e,j(b.random(),a)}([],e.rand,256,6,52);/*!
 End seedrandom.js
 */
var i={};e._helpers=i;var j=["jsavarray","jsavhorizontalarray","jsavverticalarray","jsavbararray","jsavindexed","jsavnode","jsavindex","jsavcommontree","jsavtree","jsavbinarytree","jsavbinarynode","jsavtreenode","jsavlistnode","jsavlist","jsavverticallist","jsavhorizontallist","jsavmatrix","jsavgraphnode","jsavvariable","jsavedge"];i.setElementClasses=function(a,b){for(var c=a[0],d=c.classList,e=Array.prototype.slice.call(a[0].classList,0),f=e.length;f--;){var g=e[f];-1===j.indexOf(g)&&-1===b.indexOf(g)&&d.remove(g)}for(f=b.length;f--;)g=b[f],d.contains(g)||d.add(g)},i.elementClasses=function(a){for(var b=Array.prototype.slice.call(a[0].classList,0),c=[],d=b.length;d--;)-1===j.indexOf(b[d])&&c.push(b[d]);return c},i.css=function(a,b,c){return"string"==typeof a&&"undefined"==typeof b?this.element.css(a):this._setcss(a,b,c)},i._setcss=function(b,c,d){var e,f,g=this.element,h=d;if("string"==typeof b&&"undefined"!=typeof c)e={},e[b]=g.css(b),f={},f[b]=c,c=void 0;else{e=a.extend(!0,{},b);for(var i in b)b.hasOwnProperty(i)&&(e[i]=g.css(i));h=c,f=b}return this.jsav._shouldAnimate()?this.jsav.effects.transition(this.element,f,h):this.element.css(f),[e,c,d]},i.getIndices=function(b,c){if("undefined"==typeof c)return b;if(a.isFunction(c))return b.filter(c);if(a.isArray(c))return b.filter(function(a){for(var b=0;b<c.length;b++)if(c[b]===a)return!0;return!1});if("number"==typeof c)return b.eq(c);if("boolean"==typeof c)return c?b:a({});try{return b.eq(parseInt(c,10))}catch(d){return a({})}},i.normalizeIndices=function(a,b,c){var d,e,f=[],g=this.getIndices(a,b);for("undefined"!=typeof c&&(g=g.filter(c)),d=0,e=g.size();e>d;d++)f.push(a.index(g.get(d)));return f},i.cssEquals=function(b,c,d){var e,f;if(a.isArray(d)){for(f=0;f<d.length;f++)if(e=d[f],b.css(e)!==c.css(e))return!1}else if(e=d,b.css(e)!==c.css(e))return!1;return!0},i.classEquals=function(b,c,d){var e,f,g;if(a.isArray(d)){for(f=0,g=d.length;g>f;f++)if(e=d[f],b.hasClass(e)!==c.hasClass(e))return!1}else if(e=d,b.hasClass(e)!==c.hasClass(e))return!1;return!0};var k=function(a,b,c,d,e,f){var g=a.element,h=g.position();g.position({my:f,at:e,of:b,offset:c+" "+d,collision:"none"});var i=g.position(),j=i.left,k=i.top;return j===h.left&&k===h.top?{left:0,top:0}:(g.css({left:h.left,top:h.top}),a.moveTo(j,k),{left:j-h.left,top:k-h.top})};i._setRelativeFollowUpdater=function(b,c,d){b._relativehandle&&(b._relativetarget._unregisterMoveListener(b._relativehandle),b.jsav.container.off("jsav-updaterelative",b._updaterelativehandle));var e=0,f=0,g=d&&a.isFunction(d.callback),h=function(){(0!==e||0!==f)&&(b.translate(e,f),e=0,f=0)},i=function(a,b,c){a.stopPropagation(),g&&d.callback(b,c),e+=b,f+=c};(!d||d.autotranslate)&&b.jsav.container.on("jsav-updaterelative",h),b._relativetarget=c,b._relativehandle=i,b._updaterelativehandle=h,c._registerMoveListener(i)},i.setRelativePositioning=function(b,c){var d=b.element,e=c.relativeTo,f=c.anchor||"center",g=c.myAnchor||"center",h=!!c.follow;e instanceof jQuery||(e=e.nodeType===Node.ELEMENT_NODE?a(e):e.constructor===JSAV._types.ds.AVArray&&"relativeIndex"in c?e.index(c.relativeIndex).element:JSAV.utils.isGraphicalPrimitive(e)?a(e.rObj.node):e.element||e),d.css({position:"absolute"});var i=parseInt(c.left||0,10),j=parseInt(c.top||0,10);if(b._relativehandle){var l=k(b,e,i,j,f,g);a.isFunction(c.callback)&&c.callback(l.left,l.top)}else d.position({my:g,at:f,of:e,offset:i+" "+j,collision:"none"});h&&this._setRelativeFollowUpdater(b,c.relativeTo,a.extend({autotranslate:!0},c))},i.handlePosition=function(a){var b=a.element,c=a.options;if("relativeTo"in c||"left"in c||"top"in c||"bottom"in c||"right"in c){var d,e=["right","bottom","top","left"],f={position:"absolute"};if(c.center=!1,"relativeTo"in c&&c.relativeTo)this.setRelativePositioning(a,c);else for(var g=e.length;g--;)d=e[g],c.hasOwnProperty(d)&&(f[e[g]]=c[d]),b.css(f)}},i.handleVisibility=function(a,b){a.element.css("display","none");var c="boolean"==typeof b.visible&&b.visible===!0;c&&a.show(b)},i._toggleClass=function(b,c){var d=a.extend({animate:!0},c);return this.jsav._shouldAnimate()&&d.animate?this.jsav.effects._toggleClass(this.element,b,c):this.element.toggleClass(b),[b,c]},i.addClass=function(a,b){return this.element.hasClass(a)?this:this.toggleClass(a,b)},i.removeClass=function(a,b){return this.element.hasClass(a)?this.toggleClass(a,b):this},i.hasClass=function(a){return this.element.hasClass(a)}}}(jQuery),function(a){"use strict";if("undefined"!=typeof JSAV){var b=function(a,b){this.jsav=a,this.output=b,this.output&&"title"in a.options&&this.output.html("<div class='jsavtitle'>"+a.options.title+"</div>")};b.prototype.umsg=JSAV.anim(function(b,c){c&&c.fill&&"object"==typeof c.fill&&(b=JSAV.utils.replaceLabels(b,c.fill));var d=a.extend({color:"black",preserve:!1},c);if(this.output)if(this.output.hasClass("jsavline")&&d.preserve){var e=this.output.find("div:last"),f="<span style='color:"+d.color+";'>"+b+"</span>";e.size()>0?e.append(f):this.output.html("<div style='color:"+d.color+";'>"+b+"</div>")}else this.output.hasClass("jsavline")?this.output.html("<div style='color:"+d.color+";'>"+b+"</div>"):(this.output.append("<div style='color:"+d.color+";'>"+b+"</div>"),this.output[0]&&(this.output[0].scrollTop=this.output[0].scrollHeight));return this.jsav.RECORD||this.jsav.container.trigger("jsav-message",[b,c]),this}),b.prototype.clear=JSAV.anim(function(){this.output&&this.output.html("")}),b.prototype.state=function(a){return a?(this.output.html(a),void this.jsav.container.trigger("jsav-message",[a,this.options])):this.output.html()||"<span/>"},JSAV.ext.umsg=function(a,b){this._msg.umsg(a,b)},JSAV.ext.clearumsg=function(){this._msg.clear()},JSAV.init(function(c){var d=c.output?a(c.output):a(this.container).find(".jsavoutput");this._msg=new b(this,d)})}}(jQuery),function(a){"use strict";function b(a,b,c){b===!0?a.queue(c):b?a.queue(b,c):c()}a.fn.extend({jsavToggleClass:function(c,d){var e=this,f=a.extend({queue:!0,easing:"linear",delay:0},d);f.duration=jQuery.fx.off?0:"number"==typeof f.duration?f.duration:f.duration in jQuery.fx.speeds?jQuery.fx.speeds[f.duration]:jQuery.fx.speeds._default,a.cssEase[f.easing]&&(f.easing=a.cssEase[f.easing]);var g="all "+f.duration+"ms "+f.easing;if(f.delay&&(g+=" "+f.delay+"ms"),0===f.duration)return this.toggleClass(this,arguments);var h=!1,i=function(b){var d=!1,i=!1,j=function(){i||(i=!0,d&&e.unbind(a.support.transitionEnd,j),e.each(function(){this.style[a.support.transition]=null}),"function"==typeof f.complete&&f.complete.apply(e),"function"==typeof b&&b())};f.duration>0&&a.support.transitionEnd&&a.transit.useTransitionEnd&&(d=!0,e.bind(a.support.transitionEnd,j)),window.setTimeout(j,f.duration),h||e.each(function(){f.duration>0&&(this.style[a.support.transition]=g),a(this).toggleClass(c)}),h=!0},j=function(a){this.offsetWidth,i(a)};return b(e,f.queue,j),this}});var c=function(){var a={args1:[],args2:[],from:arguments[0]},b=1;return"number"==typeof arguments[1]&&(a.args1=[arguments[1]],b=2),a.to=arguments[b],"number"==typeof arguments[b+1]&&(a.args2=[arguments[b+1]]),a},d=function(b){var c,d,e,f=b.from,g=b.to,h=f.value.apply(f,b.args1),i=g.value.apply(g,b.args2);if("swap"===b.mode?f.value.apply(f,b.args1.concat([i,{record:!1}])):("move"===b.mode||"undefined"!=typeof b.old)&&f.value.apply(f,b.args1.concat(["undefined"!=typeof b.old?b.old:"",{record:!1}])),g.value.apply(g,b.args2.concat([h,{record:!1}])),c=f.constructor===JSAV._types.ds.AVArray?f.element.find("li:eq("+b.args1[0]+") .jsavvaluelabel"):f.element.hasClass("jsavlabel")?f.element:f.element.find(".jsavvaluelabel"),d=g.constructor===JSAV._types.ds.AVArray?g.element.find("li:eq("+b.args2[0]+") .jsavvaluelabel"):g.element.hasClass("jsavlabel")?g.element:g.element.find(".jsavvaluelabel"),this._shouldAnimate()){var j=d.height(),k=c.height();if(d.position({of:c}),"swap"===b.mode)if(e=a.extend({},d.position()),d.css("bar"!==g.options.layout?{left:0,top:0}:{left:0,bottom:0,top:""}),c.position({of:d}),d.css(e),"bar"!==f.options.layout)c.transition({left:0,top:0},this.SPEED,"linear");else{var l=c.parent().height()-c.position().top-k;c.css({top:"",bottom:l}),c.transition({left:0,bottom:0},this.SPEED,"linear")}if("bar"!==g.options.layout)d.transition({left:0,top:0},this.SPEED,"linear");else{var l=d.parent().height()-d.position().top-j;d.css({top:"",bottom:l}),d.transition({left:0,bottom:0},this.SPEED,"linear")}}return[{from:g,args1:b.args2,to:f,args2:b.args1,old:i,mode:b.mode}]};JSAV.ext.effects={_toggleClass:function(a,b,c){this._animations+=a.length;var d=this;a.jsavToggleClass(b,{duration:c&&c.duration||this.SPEED,delay:c&&c.delay||0,complete:function(){d._animations--}})},transition:function(a,b,c){this._animations+=a.length;var d=this;a.transition(b,{duration:c&&c.duration||this.SPEED,delay:c&&c.delay||0,complete:function(){d._animations--}})},_toggleVisible:function(){return this.jsav._shouldAnimate()?this.element.fadeToggle(this.jsav.SPEED):this.element.toggle(),[]},show:function(a){return 0===this.element.filter(":visible").size()&&this._toggleVisible(a),this},hide:function(a){return this.element.filter(":visible").size()>0&&this._toggleVisible(a),this},copyValue:function(){var a=c.apply(null,arguments);JSAV.anim(d).call(this,a)},moveValue:function(){var a=c.apply(null,arguments);a.mode="move",JSAV.anim(d).call(this,a)},swapValues:function(){var a=c.apply(null,arguments);a.mode="swap",JSAV.anim(d).call(this,a)},swap:function(b,c,d){var e=a.extend({translateY:!0,arrow:!0,highlight:!0,swapClasses:!1},d),f=b.find("span.jsavvalue"),g=c.find("span.jsavvalue"),h=b.attr("class"),i=c.attr("class"),j=JSAV.position(b).left-JSAV.position(c).left,k=e.translateY?JSAV.position(b).top-JSAV.position(c).top:0,l=a(b).add(c),m=this.SPEED/5,n=f[0],o=g[0],p=n.parentNode,q=n.nextSibling===o?n:n.nextSibling;if(o.parentNode.insertBefore(n,o),p.insertBefore(o,q),e.swapClasses&&(b.attr("class",i),c.attr("class",h)),this._shouldAnimate()){if("Raphael"in window&&e.arrow){var r=f.offset(),s=g.offset(),t=this.canvas.offset(),u=r.left-t.left+f.outerWidth()/2,v=s.left-t.left+g.outerWidth()/2,w=r.top-t.top+f.outerHeight()+5,x=w,y=20,z=u,A=v,B=x+y,C=x+y,D="classic-wide-long";if(k>1||1>k){x=s.top-t.top+g.outerHeight()+5;var E=(x-w)/(v-u),F=Math.pow(w,2)-y*y/(1+E*E),G=Math.pow(x,2)-y*y/(1+E*E);B=w+Math.sqrt(w*w-F),z=u-E*Math.sqrt(w*w-F),C=x+Math.sqrt(x*x-G),A=v-E*Math.sqrt(x*x-G)}var H=this.getSvg().path("M"+u+","+w+"C"+z+","+B+" "+A+","+C+" "+v+","+x).attr({"arrow-start":D,"arrow-end":D,"stroke-width":5,stroke:"lightGray"})}g.css({x:-j,y:-k,z:1}),f.css({x:j,y:k,z:1}),this._animations+=1;var I=this;e.highlight&&l.addClass("jsavswap",3*m),f.transition({x:0,y:0,z:0},7*m,"linear"),g.transition({x:0,y:0,z:0},7*m,"linear",function(){H&&H.remove(),e.highlight&&l.removeClass("jsavswap",3*m),I._animations-=1})}}}}(jQuery),function(a){"use strict";var b=["click","dblclick","mousedown","mousemove","mouseup","mouseenter","mouseleave"],c=function(b,c){return function(d,e,f){var g={edge:!1},h=this.jsav,i=g;return"object"==typeof f?i=a.extend(g,f):"object"==typeof e&&(i=a.extend(g,e)),(!i.edge||i.node)&&this.element.on(b,c.selector,function(f){for(var g=a(this),i=g.data(c.dataField);!i;)g=g.parent(),i=g.data(c.dataField);if(h.logEvent({type:c.logEventPrefix+b,objid:i.id(),objvalue:i.value()}),a.isFunction(d))d.call(i,f);else if(a.isFunction(e)){var j=a.isArray(d)?d.slice(0):[d];j.push(f),e.apply(i,j)}}),i.edge&&this.jsav.canvas.on(b,'.jsavedge[data-container="'+this.id()+'"]',function(c){var f=a(this).data("edge");if(h.logEvent({type:"jsav-edge-"+b,startvalue:f.start().value(),endvalue:f.end().value(),startid:f.start().id(),endid:f.end().id()}),a.isFunction(d))d.call(f,c);else if(a.isFunction(e)){var g=a.isArray(d)?d.slice(0):[d];g.push(c),e.apply(f,g)}}),this}},d=function(a){return function(b,d,e,f){return c(b,a).call(this,d,e,f),this}};JSAV.utils._events={_addEventSupport:function(e,f){for(var g=a.extend({selector:".jsavnode",logEventPrefix:"jsav-node-",dataField:"node"},f),h=b.length;h--;)e[b[h]]=c(b[h],g);e.on=d(g)}}}(jQuery),"undefined"!=typeof Raphael)!function(a){"use strict";if("undefined"!=typeof JSAV){var b=function(){};b.prototype={show:function(a){1!==this.css("opacity")&&this.css({opacity:1},a)},hide:function(a){0!==this.css("opacity")&&this.css({opacity:0},a)},isVisible:function(){return 0!==this.css("opacity")},transform:function(a,b){var c=this.rObj.transform();return this.jsav._shouldAnimate()?this.rObj.animate({transform:a},this.jsav.SPEED):this.rObj.transform(a,b),c},rotate:JSAV.anim(function(a){return this.transform("...r"+a),[0-a]}),scale:JSAV.anim(function(a,b){return this.transform("...S"+a+","+b),[1/a,1/b]}),scaleX:function(a,b){return this.scale(a,1,b)},scaleY:function(a,b){return this.scale(1,a,b)},translate:JSAV.anim(function(a,b){return this.transform("...T"+a+","+b),[0-a,0-b]}),translateX:function(a,b){return this.translate(a,0,b)},translateY:function(a,b){return this.translate(0,a,b)},_setattrs:JSAV.anim(function(b,c){var d=a.extend(!0,{},b);for(var e in b)b.hasOwnProperty(e)&&(d[e]=this.rObj.attr(e));if(!this.jsav._shouldAnimate()||c&&c.dontAnimate)for(e in b)b.hasOwnProperty(e)&&this.rObj.attr(e,b[e]);else this.rObj.animate(b,this.jsav.SPEED);return[d]}),css:function(a,b){return"string"==typeof a?this.rObj.attr(a):this._setattrs(a,b)},state:function(b){if("undefined"!=typeof b){for(var c in b)b.hasOwnProperty(c)&&this.rObj.attr(c,b[c]);return this}var d=a.extend(!0,{},this.rObj.attrs);return d},bounds:function(){var a=this.rObj.getBBox();return{left:a.x,top:a.y,width:a.width,height:a.height}},id:JSAV._types.JSAVObject.prototype.id,clear:function(){this.rObj.remove()}};var c=b.prototype;c.addClass=JSAV.utils._helpers.addClass,c.removeClass=JSAV.utils._helpers.removeClass,c.hasClass=JSAV.utils._helpers.hasClass,c.toggleClass=JSAV.anim(JSAV.utils._helpers._toggleClass);for(var d=["click","dblclick","mousedown","mousemove","mouseup","mouseenter","mouseleave"],e=function(b){return function(c,d){var e=this;return this.element.on(b,function(f){if(e.jsav.logEvent({type:"jsav-graphical-"+b,objid:e.id()}),a.isFunction(c))c.call(e,f);else if(a.isFunction(d)){var g=a.isArray(c)?c.slice(0):[c];g.push(f),d.apply(e,g)}}),this}},f=d.length;f--;)c[d[f]]=e(d[f]);c.on=function(a,b,c){return e(a).call(this,b,c),this};var g=function(b,c,d){b.jsav=c,b.element=a(b.rObj.node).data("svgelem",b.rObj);var e=a.extend({visible:!0},d);for(var f in e)e.hasOwnProperty(f)&&b.rObj.attr(f,e[f]);if(!("opacity"in e)){b.rObj.attr("opacity",0);var g="boolean"==typeof e.visible&&e.visible===!0;g&&b.show(e)}},h=function(a,b,c,d){var e,f=this.rObj.attrs.path,g="";if(a>f.length)return this;for(var h=0,i=f.length;i>h;h++)e=f[h],g+=h===a?e[0]+" "+(+e[1]+b)+" "+(+e[2]+c):e.join(" ");return this._setattrs({path:g},d),this},i=function(b,c){var d,e,f,g=this.rObj.attrs.path,h=g.slice();for(e=0,f=b.length;f>e;e++){var i=b[e];d=g[i[0]],h[i[0]]=[d[0],i[1],i[2]]}var j="";for(e=0,f=h.length;f>e;e++)d=h[e],j+=d.join(" ");return this._setattrs({path:j},a.extend({dontAnimate:""+g=="M-1,-1L-1,-1"},c)),this},j=function(){return this._points.slice(0)},k=function(a,b,c,d,e,f){return this.rObj=b.circle(c,d,e),g(this,a,f),this};JSAV.utils.extend(k,b);var l=k.prototype;l.center=function(b,c,d){return"undefined"==typeof b?this.rObj.attr(["cx","cy"]):(a.isArray(b)&&2===b.length?this._setattrs({cx:b[0],cy:b[1]},d):"undefined"!=typeof c?this._setattrs({cx:b,cy:c},d):"cx"in b&&"cy"in b&&this._setattrs(b,d),this)},l.radius=function(a,b){return"undefined"==typeof a?this.rObj.attr("r"):(this._setattrs({r:a},b),this)};var m=function(a,b,c,d,e,f,h,i){return this.rObj=b.rect(c,d,e,f,h),g(this,a,i),this};JSAV.utils.extend(m,b);var n=m.prototype;n.width=function(a,b){return"undefined"==typeof a?this.rObj.attr("width"):(this._setattrs({width:a},b),this)},n.height=function(a,b){return"undefined"==typeof a?this.rObj.attr("height"):(this._setattrs({height:a},b),this)};var o=function(a,b,c,d,e,f,h){return this.rObj=b.path("M"+c+" "+d+"L"+e+" "+f),g(this,a,h),this._points=[[c,d],[e,f]],this};JSAV.utils.extend(o,b),o.prototype.translatePoint=h,o.prototype._polylineMovePoints=i,o.prototype.movePoints=function(b,c,d,e){return this._polylineMovePoints(a.isArray(b)?b:[[0,b,c],[1,d,e]])},o.prototype.points=j;var p=function(a,b,c,d,e,f,h){return this.rObj=b.ellipse(c,d,e,f),g(this,a,h),this};JSAV.utils.extend(p,b);var q=p.prototype;q.center=l.center,q.radius=function(b,c,d){return"undefined"==typeof b?this.rObj.attr(["rx","ry"]):(a.isArray(b)&&2===b.length?this._setattrs({rx:b[0],ry:b[1]},d):"undefined"!=typeof c?this._setattrs({rx:b,ry:c},d):"rx"in b&&"ry"in b&&this._setattrs(b,d),this)};var r=function(a,b,c,d,e){for(var f="M ",h=0,i=c.length;i>h;h++)h&&(f+="L"),f+=c[h][0]+" "+c[h][1];return d&&(f+="Z"),this.rObj=b.path(f),g(this,a,e),this._points=c,this};JSAV.utils.extend(r,b),r.prototype.translatePoint=h,r.prototype.movePoints=i,r.prototype.points=j;var s=function(a,b,c,d){return this.rObj=b.path(c),g(this,a,d),this};JSAV.utils.extend(s,b),s.prototype.path=function(a,b){return"undefined"==typeof a?this.rObj.attr("path"):this._setattrs({path:a},b)};var t=function(a,b,c){return this.rObj=b.set(),g(this,a,c),this};JSAV.utils.extend(t,b);var u=t.prototype;u.push=function(a){return this.rObj.push(a.rObj),this};var v=function(a,b){return"undefined"!=typeof b&&b.container?b.container.getSvg():a.getSvg()};JSAV.ext.g={circle:function(a,b,c,d){var e=v(this,d);return new k(this,e,a,b,c,d)},rect:function(a,b,c,d,e,f){"object"==typeof e&&(f=e,e=0);var g=v(this,f);return new m(this,g,a,b,c,d,e,f)},line:function(a,b,c,d,e){var f=v(this,e);return new o(this,f,a,b,c,d,e)},ellipse:function(a,b,c,d,e){var f=v(this,e);return new p(this,f,a,b,c,d,e)},polyline:function(a,b){var c=v(this,b);return new r(this,c,a,!1,b)},polygon:function(a,b){var c=v(this,b);return new r(this,c,a,!0,b)},path:function(a,b){var c=v(this,b);return new s(this,c,a,b)},set:function(a){var b=v(this,a);return new t(this,b)}};var w={JSAVGraphical:b,Circle:k,Rect:m,Line:o,Ellipse:p,Polyline:r,Path:s,Set:t};JSAV._types.g=w;var x=["circle","path","rect","ellipse","line","polyline","polygon"],y=a.cssHooks.width,z=a.cssHooks.height;a.cssHooks.width={get:function(a,b,c){return-1!==x.indexOf(a.nodeName)?a.getBoundingClientRect().width:y.get(a,b,c)},set:y.set},a.cssHooks.height={get:function(a,b,c){return-1!==x.indexOf(a.nodeName)?a.getBoundingClientRect().height:z.get(a,b,c)},set:z.set},/*!
    Following utility functions for handling SVG elements add/remove/toggle/hasClass
    functions are implemented by Keith Wood. See:
   http://keith-wood.name/svg.html
   jQuery DOM compatibility for jQuery SVG
   Written by Keith Wood (kbwood{at}iinet.com.au) April 2009.
   Dual licensed under the GPL (http://dev.jquery.com/browser/trunk/jquery/GPL-LICENSE.txt) and 
   MIT (http://dev.jquery.com/browser/trunk/jquery/MIT-LICENSE.txt) licenses. 
   Please attribute the author if you use it. */
a.svg={isSVGElem:function(a){return 1==a.nodeType&&"http://www.w3.org/2000/svg"==a.namespaceURI}},a.fn.addClass=function(b){return function(c){return c=c||"",this.each(function(){if(a.svg.isSVGElem(this)){var d=this;a.each(c.split(/\s+/),function(b,c){var e=d.className?d.className.baseVal:d.getAttribute("class");-1==a.inArray(c,e.split(/\s+/))&&(e+=(e?" ":"")+c,d.className?d.className.baseVal=e:d.setAttribute("class",e))})}else b.apply(a(this),[c])})}}(a.fn.addClass),a.fn.removeClass=function(b){return function(c){return c=c||"",this.each(function(){if(a.svg.isSVGElem(this)){var d=this;a.each(c.split(/\s+/),function(b,c){var e=d.className?d.className.baseVal:d.getAttribute("class");e=a.grep(e.split(/\s+/),function(a){return a!=c}).join(" "),d.className?d.className.baseVal=e:d.setAttribute("class",e)})}else b.apply(a(this),[c])})}}(a.fn.removeClass),a.fn.toggleClass=function(b){return function(c,d){return this.each(function(){a.svg.isSVGElem(this)?("boolean"!=typeof d&&(d=!a(this).hasClass(c)),a(this)[(d?"add":"remove")+"Class"](c)):b.apply(a(this),[c,d])})}}(a.fn.toggleClass),a.fn.hasClass=function(b){return function(c){c=c||"";var d=!1;return this.each(function(){if(a.svg.isSVGElem(this)){var e=(this.className?this.className.baseVal:this.getAttribute("class")).split(/\s+/);d=a.inArray(c,e)>-1}else d=b.apply(a(this),[c]);return!d}),d}}(a.fn.hasClass)}}(jQuery,Raphael);else{for(var error=function(){console.error("You are trying to use graphical primitives but forgot to load Raphael.js.")},g={},names=["circle","rect","line","ellipse","polyline","polygon","path","set"],i=names.length;i--;)g[names[i]]=error;JSAV.ext.g=g}!function(a){"use strict";if("undefined"!=typeof JSAV){var b=function(b,c,d){this.jsav=b,this.options=a.extend({visible:!0},d),this.element=a('<div class="jsavlabel">'+c+"</div>"),this.options.before?this.element.insertBefore(this.options.before.element):this.options.after?this.element.insertAfter(this.options.after.element):this.options.container?this.options.container.append(this.element):a(this.jsav.canvas).append(this.element),JSAV.utils._helpers.handlePosition(this),JSAV.utils._helpers.handleVisibility(this,this.options)};JSAV.utils.extend(b,JSAV._types.JSAVObject);var c=b.prototype;c._toggleVisible=JSAV.anim(JSAV.ext.effects._toggleVisible),c.show=JSAV.ext.effects.show,c.hide=JSAV.ext.effects.hide,c._setText=JSAV.anim(function(a){this.element.html(a)}),c.text=function(a,b){return"undefined"==typeof a?this.element.html():(this._setText(a,b),this)},c.value=c.text,c.state=function(a){if("undefined"==typeof a){var b={t:this.text()},c=this.element.attr("style"),d=JSAV.utils._helpers.elementClasses(this.element);return d.length>0&&(b.cls=d),c&&(b.css=c),b}this.text(a.t,{record:!1}),JSAV.utils._helpers.setElementClasses(this.element,a.cls||[]),this.element.attr("style",a.css||"")},c.equals=function(a,c){if(!(a&&a instanceof b&&this.text()===a.text()))return!1;if(c&&"css"in c){var d=JSAV.utils._helpers.cssEquals(this,a,c.css);if(!d)return!1}if(c&&"class"in c){var e=JSAV.utils._helpers.classEquals(this,a,c["class"]);if(!e)return!1}return!0},c.css=JSAV.utils._helpers.css,c._setcss=JSAV.anim(JSAV.utils._helpers._setcss),c.addClass=JSAV.utils._helpers.addClass,c.removeClass=JSAV.utils._helpers.removeClass,c.hasClass=JSAV.utils._helpers.hasClass,c.toggleClass=JSAV.anim(JSAV.utils._helpers._toggleClass),JSAV._types.Label=b,JSAV.ext.label=function(a,c){return new b(this,a,c)}}}(jQuery),function(a){"use strict";function b(a){for(var b=Math.PI;0>a;)a+=2*b;for(;a>=2*b;)a-=2*b;return a}function c(a,b,c,d){function e(a,b,c){return{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}}var f={},g=(b.x-a.x)*(b.x-a.x)+(b.y-a.y)*(b.y-a.y),h=2*((b.x-a.x)*(a.x-c.x)+(b.y-a.y)*(a.y-c.y)),i=c.x*c.x+c.y*c.y+a.x*a.x+a.y*a.y-2*(c.x*a.x+c.y*a.y)-d*d,j=h*h-4*g*i;if(0>=j)f.inside=!1;else{var k=Math.sqrt(j),l=(-h+k)/(2*g),m=(-h-k)/(2*g);(0>l||l>1)&&(0>m||m>1)?f.inside=0>l&&0>m||l>1&&m>1?!1:!0:(m>=0&&1>=m&&(f.enter=e(a,b,m)),l>=0&&1>=l&&(f.exit=e(a,b,l)),f.intersects=!0)}return f}function d(a,b,d,e){a.width=Math.max(a.width,1),a.height=Math.max(a.height,1);var f,g,h,i,j,k,l,m=Math.PI,n=Math.atan2(2*a.height,2*a.width),o=m-n,p=2*m-n,q=n+m;return e=Math.min(e,a.width,a.height),n>d||d>p?(i=Math.atan2(a.height-e,a.width),j=2*m-i,f=a.x+a.width,g=a.y-a.width*Math.tan(d),e>0&&d>i&&j>d&&(h=j>d&&d>m?c({x:a.x,y:a.y},b,{x:a.x+a.width-e,y:a.y+a.height-e},e):c({x:a.x,y:a.y},b,{x:a.x+a.width-e,y:a.y-a.height+e},e))):d>o&&q>d?(i=m-Math.atan2(a.height-e,a.width),j=2*m-i,f=a.x-a.width,g=a.y+a.width*Math.tan(d),e>0&&(i>d||d>j)&&(h=i>d?c({x:a.x,y:a.y},b,{x:a.x-a.width+e,y:a.y-a.height+e},e):c({x:a.x,y:a.y},b,{x:a.x-a.width+e,y:a.y+a.height-e},e))):o>=d?(l=Math.atan2(a.height,a.width-e),k=m-l,g=a.y-a.height,f=a.x+a.height/Math.tan(d),e>0&&(d>k||l>d)&&(h=d>k?c({x:a.x,y:a.y},b,{x:a.x-a.width+e,y:a.y-a.height+e},e):c({x:a.x,y:a.y},b,{x:a.x+a.width-e,y:a.y-a.height+e},e))):(k=m+Math.atan2(a.height,a.width-e),l=2*m-Math.atan2(a.height,a.width-e),g=a.y+a.height,f=a.x-a.height/Math.tan(d),e>0&&(k>d||d>l)&&(h=d>l?c({x:a.x,y:a.y},b,{x:a.x+a.width-e,y:a.y+a.height-e},e):c({x:a.x,y:a.y},b,{x:a.x-a.width+e,y:a.y+a.height-e},e))),h&&h.exit&&(f=h.exit.x,g=h.exit.y),[Math.round(f),Math.round(g)]}if("undefined"!=typeof JSAV){a.fn.getstyles=function(){for(var b,c={},d=0;d<arguments.length;d++)if(b=arguments[d],a.isArray(b))for(var e=0;e<b.length;e++)c[b[e]]=this.css(b[e]);else c[b]=this.css(b);return c};var e=function(){};JSAV.utils.extend(e,JSAV._types.JSAVObject);var f=e.prototype;f.getSvg=function(){if(!this.svg){this.svg=new Raphael(this.element[0]),this.svg.renderfix();var a=this.svg.canvas.style;a.position="absolute"}return this.svg},f._toggleVisible=JSAV.anim(JSAV.ext.effects._toggleVisible),f.show=JSAV.ext.effects.show,f.hide=JSAV.ext.effects.hide,f.addClass=JSAV.utils._helpers.addClass,f.removeClass=JSAV.utils._helpers.removeClass,f.hasClass=JSAV.utils._helpers.hasClass,f.toggleClass=JSAV.anim(JSAV.utils._helpers._toggleClass),f.initialize=function(){},f.initializeFromElement=function(){},f.clone=function(){};var g=function(b,c,d,e){this.jsav=b,this.startnode=c,this.endnode=d,this.options=a.extend(!0,{display:!0},e),this.container=c.container;var f=c?c.element.position():{left:0,top:0},g=d?d.element.position():{left:0,top:0};f.left===g.left&&f.top===g.top?this.g=this.jsav.g.line(-1,-1,-1,-1,a.extend({container:this.container},this.options)):(d&&(g.left+=d.element.outerWidth()/2,g.top+=d.element.outerHeight()),f.left||f.top||(f=g),this.g=this.jsav.g.line(f.left,f.top,g.left,g.top,a.extend({container:this.container},this.options))),this.element=a(this.g.rObj.node);var h="boolean"==typeof this.options.display&&this.options.display===!0;this.g.rObj.attr({opacity:0}),this.element.addClass("jsavedge"),c&&this.element[0].setAttribute("data-startnode",this.startnode.id()),d&&this.element[0].setAttribute("data-endnode",this.endnode.id()),this.element[0].setAttribute("data-container",this.container.id()),this.element.data("edge",this),"undefined"!=typeof this.options.weight&&(this._weight=this.options.weight,this.label(this._weight)),h&&this.g.show()};JSAV.utils.extend(g,e);var h=g.prototype;h.start=function(a){return"undefined"==typeof a?this.startnode:(this.startnode=a,this.g.rObj.node.setAttribute("data-startnode",this.startnode?this.startnode.id():""),this)},h.end=function(a){return"undefined"==typeof a?this.endnode:(this.endnode=a,this.g.rObj.node.setAttribute("data-endnode",this.endnode?this.endnode.id():""),this)},h._setweight=JSAV.anim(function(a){var b=this._weight;return this._weight=a,[b]}),h.weight=function(a){return"undefined"==typeof a?this._weight:(this._setweight(a),void this.label(a))},h.clear=function(){this.g.rObj.remove()},h.hide=function(a){this.g.isVisible()&&(this.g.hide(a),this._label&&this._label.hide(a))},h.show=function(a){this.g.isVisible()||(this.g.show(a),this._label&&this._label.show(a))},h.isVisible=function(){return this.g.isVisible()},h.label=function(a,b){if("undefined"==typeof a)return this._label&&this._label.element.filter(":visible").size()>0?this._label.text():void 0;if(this._label)this._label.text(a,b);else{var c=this,d=function(a){if(c._label){var b=a&&a.bbox?a.bbox:c.g.bounds(),d=c._label.bounds(),e=b.top+(b.height-d.height)/2,f=b.left+(b.width-d.width)/2;(e!==d.top||f||d.left)&&c._label.css({top:e,left:f},a)}};this._labelPositionUpdate=d,this._label=this.jsav.label(a,{container:this.container.element}),this._label.element.addClass("jsavedgelabel")}},h.equals=function(a,b){if(!a||!a instanceof g)return!1;if(!(!b||b.dontCheckNodes||this.startnode.equals(a.startnode)&&this.endnode.equals(a.endnode)))return!1;if(this._weight!==a._weight)return!1;if(b&&"css"in b){var c=JSAV.utils._helpers.cssEquals(this,a,b.css);if(!c)return!1}if(b&&"class"in b){var d=JSAV.utils._helpers.classEquals(this,a,b["class"]);if(!d)return!1}return!0},h._setcss=JSAV.anim(function(b,c){var d,e=a.extend(!0,{},b),f=this.g.rObj;if("string"==typeof b&&"undefined"!=typeof c)e[b]=f.attr(b),d={},d[b]=c;else{for(var g in b)b.hasOwnProperty(g)&&(e[g]=f.attr(g));d=b}return this.jsav._shouldAnimate()?f.animate(d,this.jsav.SPEED):f.attr(d),[e]}),h.css=function(a,b,c){return"string"==typeof a&&"undefined"==typeof b?this.g.rObj.attr(a):this._setcss(a,b,c)},h.state=function(a){if("undefined"==typeof a){var b={a:this.g.rObj.attrs},c=JSAV.utils._helpers.elementClasses(this.element);return c.length>0&&(b.cls=c),this.label()&&(b.l=this.label()),this._weight&&(b.w=this.weight()),b}this.g.css(a.a),JSAV.utils._helpers.setElementClasses(this.element,a.cls||[]),a.l?this.label(a.l,{record:!1}):this.label()&&this.label(""),a.w?this.weight(a.w):this.weight()&&this.weight("")},h.position=function(){var a=this.g.bounds();return{left:a.left,top:a.top}},h.addClass=function(a,b){return this.element.hasClass(a)?this:this.toggleClass(a,b)},h.removeClass=function(a,b){return this.element.hasClass(a)?this.toggleClass(a,b):this},h.hasClass=function(a){return this.element.hasClass(a)},h.toggleClass=JSAV.anim(function(a,b){return this.element.toggleClass(a),[a,b]}),h.highlight=function(a){this.addClass("jsavhighlight",a)},h.unhighlight=function(a){this.removeClass("jsavhighlight",a)},h.layout=function(c){var e=this.start().element,f=this.end().element,g=c&&c.start?c.start:this.start().position(),h=c&&c.end?c.end:this.end().position(),i=e.outerWidth()/2,j=e.outerHeight()/2,k=f.outerWidth()/2,l=f.outerHeight()/2,m=c&&c.fromPoint?c.fromPoint[0]:Math.round(g.left+i),n=c&&c.fromPoint?c.fromPoint[1]:Math.round(g.top+j),o=Math.round(h.left+k),p=Math.round(h.top+l),q=b(2*Math.PI-Math.atan2(p-n,o-m)),r=b(2*Math.PI-Math.atan2(n-p,m-o)),s=parseInt(e.css("borderBottomRightRadius"),10)||0,t=c&&c.fromPoint?c.fromPoint:d({width:i,height:j,x:m,y:n},{x:o,y:p},q,s),u=parseInt(f.css("borderBottomRightRadius"),10)||0,v=d({width:k,height:l,x:o,y:p},{x:m,y:n},r,u);if(this.g.movePoints([[0].concat(t),[1].concat(v)],c),a.isFunction(this._labelPositionUpdate)){var w=Math.min(t[1],v[1]),x=Math.min(t[0],v[0]),y=Math.abs(t[0]-v[0]),z=Math.abs(t[1]-v[1]),A={top:w,left:x,width:y,height:z};this._labelPositionUpdate(a.extend({bbox:A},c))}"jsavnull"===this.start().value()||"jsavnull"===this.end().value()?this.addClass("jsavedge",c).addClass("jsavnulledge",c):this.addClass("jsavedge",c).removeClass("jsavnulledge")};var i=function(){};JSAV.utils.extend(i,e);var j=i.prototype;j.value=function(a,b){return"undefined"==typeof a?JSAV.utils.value2type(this.element.attr("data-value"),this.element.attr("data-value-type")):(this._setvalue(a,b),this)},j._setvalue=JSAV.anim(function(a){var b=this.value(),c=typeof a;return"undefined"==typeof b&&(b=""),"object"===c&&(c="string"),this.element.find(".jsavvalue").html(this._valstring(a)).end().attr({"data-value":a,"data-value-type":c}),[b]}),j._valstring=function(a){return"<span class='jsavvaluelabel'>"+a+"</span>"},j.highlight=function(){return this.addClass("jsavhighlight")},j.unhighlight=function(){return this.removeClass("jsavhighlight")},j.isHighlight=function(){return this.hasClass("jsavhighlight")},j.state=function(a){if("undefined"==typeof a){var b={v:this.value()},c=this.element.attr("style"),d=JSAV.utils._helpers.elementClasses(this.element);return d.length>0&&(b.cls=d),c&&(b.css=c),b}this.value(a.v,{record:!1}),JSAV.utils._helpers.setElementClasses(this.element,a.cls||[]),this.element.attr("style",a.css||"")},j.css=JSAV.utils._helpers.css,j._setcss=JSAV.anim(JSAV.utils._helpers._setcss),JSAV._types.ds={JSAVDataStructure:e,Edge:g,Node:i},JSAV.ext.ds={layout:{}}}}(jQuery),function(a){"use strict";if("undefined"!=typeof JSAV){var b=JSAV.utils._helpers.getIndices,c={};c.array='<span class="jsavvalue"><span class="jsavvaluelabel">{{value}}</span></span>',c["array-indexed"]=c.array+'<span class="jsavindexlabel">{{index}}</span>',c.vertical=c.array,c["vertical-indexed"]=c["array-indexed"],c.bar='<span class="jsavvaluebar"></span>'+c.array,c["bar-indexed"]=c.bar+'<span class="jsavindexlabel">{{index}}</span>';var d=function(b,c,d,e){this.jsav=b.jsav,this.container=b,this.index=d,this.options=a.extend(!0,{},e,{visible:!0});var f=b.options.template.replace("{{value}}",c).replace("{{index}}",d),g=a("<li class='jsavnode jsavindex'>"+f+"</li>");this.element=g,this.options.autoResize&&g.addClass("jsavautoresize"),this.container.element.append(g)};JSAV.utils.extend(d,JSAV._types.ds.Node);var e=d.prototype;e.value=function(a,b){return this.container.value(this.index,a,b)},e._setvalue=e.value,e.show=function(){},e.hide=function(){},e.equals=function(a,b){if(!a||this.value()!==a.value()||!a instanceof d)return!1;if(b&&"css"in b){var c=JSAV.utils._helpers.cssEquals(this,a,b.css);if(!c)return!1}if(b&&"class"in b){var e=JSAV.utils._helpers.classEquals(this,a,b["class"]);if(!e)return!1}return!0};var f=function(b,d,e){this.jsav=b,this.options=a.extend(!0,{autoresize:!0,center:!0,layout:"array"},e),this.options.template||(this.options.template=c[this.options.layout+(this.options.indexed?"-indexed":"")]),this._indices=[],a.isArray(d)?this.initialize(d):d&&(this.element=a(d),this.initializeFromElement()),this.options.autoresize&&this.element.addClass("jsavautoresize"),this.options.center&&this.element.addClass("jsavcenter"),this.options.indexed&&this.element.addClass("jsavindexed")};JSAV.utils.extend(f,JSAV._types.ds.JSAVDataStructure),f._templates=c;var g=f.prototype;g.isHighlight=function(a){return this.hasClass(a,"jsavhighlight")},g.highlight=function(a,b){return this.addClass(a,"jsavhighlight",b),this},g.unhighlight=function(a,b){return this.removeClass(a,"jsavhighlight",b),this},g._setarraycss=JSAV.anim(function(b,c){var d=a.extend(!0,{},b),e=this.element;if("object"!=typeof b)return[b];for(var f in b)b.hasOwnProperty(f)&&(d[f]=e.css(f));return this.jsav._shouldAnimate()?this.jsav.effects.transition(this.element,b,c):this.element.css(b),[d]}),g.css=function(c,d,e){var f;if("string"==typeof d)return f=b(a(this.element).find("li"),c),f.css(d);if("string"==typeof c)return this.element.css(c);if(a.isArray(c)||"object"!=typeof c){for(var g=JSAV.utils._helpers.normalizeIndices(a(this.element).find("li.jsavindex"),c),h=0,i=g.length;i>h;h++)this._indices[g[h]].css(d,e);return this}return this._setarraycss(c,e)},g.index=function(a){return this._indices[a]},g.swap=JSAV.anim(function(b,c,d){var e=a(this.element).find("li:eq("+b+")"),f=a(this.element).find("li:eq("+c+")"),g=this._values[b];return this._values[b]=this._values[c],this._values[c]=g,this.jsav.effects.swap(e,f,d),[b,c,d]}),g.clone=function(){var b=this._values,c=new f(this.jsav,b,a.extend(!0,{},this.options,{visible:!1}));return c.state(this.state()),c},g.size=function(){return this.element.find("li").size()},g.value=function(a,b,c){return"undefined"==typeof b?this._values[a]:this._setvalue(a,b,c)},g._newindex=function(a,b){"undefined"==typeof a&&(a=""),"undefined"==typeof b&&(b="");var c=new d(this,a,b,this.options);return this._indices[b]=c,c},g._setvalue=JSAV.anim(function(a,b){for(var c=this.size(),d=this.value(a);a>c-1;){{this._newindex("",c)}this._values[c]="",c=this.size()}var e=this.element.find("li:eq("+a+")");return this._values[a]=b,e.find(".jsavvaluelabel").html(""+b),[a,d]}),g.initialize=function(b){var c,d,e,f=this.options.element||a("<ol/>");for(this.options.element||a(this.jsav.canvas).append(f),this.element=f,this._values=b.slice(0),e=0;e<b.length;e++)(null===b[e]||void 0===b[e])&&(this._values[e]="");f.addClass("jsavarray"),this.options=jQuery.extend({visible:!0},this.options);for(c in this.options)this.options.hasOwnProperty(c)&&(d=this.options[c],("string"==typeof d||"number"==typeof d||"boolean"==typeof d)&&f.attr("data-"+c,d));for(e=0;e<b.length;e++)this._newindex(b[e],e);JSAV.utils._helpers.handlePosition(this),this.layout(),f.css("display","none"),JSAV.utils._helpers.handleVisibility(this,this.options)},g.initializeFromElement=function(){if(this.element){var b=this.element,c=b.find("li"),d=b.data(),e=this;for(var f in d)d.hasOwnProperty(f)&&(this.options[f]=d[f]);b.addClass("jsavarray"),this._values=[],c.each(function(b){{var c=a(this),d=JSAV.utils.value2type(c.attr("data-value")||c.html(),c.attr("data-value-type")||"string");e._newindex(d,b)}e._values[b]=d,c.remove()}),this.layout()}},g.layout=function(a){var b=this.options.layout||"_default";return this.element.removeClass("jsavbararray"),this.jsav.ds.layout.array[b](this,a)},g.state=function(a){if(!a){for(var b={ind:[]},c=b.ind,d=0,e=this._indices.length;e>d;d++)c.push(this._indices[d].state());var f=this.element.attr("style");f&&(b.style=f);var g=JSAV.utils._helpers.elementClasses(this.element);return g.length>0&&(b.classes=g),b}this.element.attr("style",a.style||""),JSAV.utils._helpers.setElementClasses(this.element,a.classes||[]);for(var h=this._indices,i=a.ind,d=0,j=h.length,k=i.length;j>d&&k>d;d++)h[d].state(i[d]);for(;j>d;){var l=h.length-1;h[l].element.remove(),h.splice(l),this._values.splice(l),d++}for(;k>d;){var m=this._newindex("",d);m.state(i[d]),d++}},g.equals=function(b,c){var d,e,f,g,h,i,j=c||{};if(!a.isArray(b)){if(i=b.size(),this.size()!==i)return!1;if(!("value"in j)||j.value)for(d=0;i>d;d++)if(f=this.value(d)==b.value(d),!f)return!1;if("css"in j)if(a.isArray(j.css)){for(d=0;d<j.css.length;d++)for(g=j.css[d],e=0;i>e;e++)if(f=this.css(e,g)===b.css(e,g),!f)return!1}else for(g=j.css,d=0;i>d;d++)if(f=this.css(d,g)===b.css(d,g),!f)return!1;if("class"in j)if(a.isArray(j["class"])){for(d=0;d<j["class"].length;d++)for(h=j["class"][d],e=0;i>e;e++)if(f=this.hasClass(e,h)===b.hasClass(e,h),!f)return!1}else for(h=j["class"],d=0;i>d;d++)if(f=this.hasClass(d,h)===b.hasClass(d,h),!f)return!1;return!0}if(!c){if(i=b.length,this.size()!==i)return!1;for(d=0;i>d;d++)if(f=this.value(d)==b[d],!f)return!1;return!0}if("css"in j){for(g=j.css,d=0;i>d;d++)if(f=this.css(d,g)===b[d],!f)return!1;return!0}return!1},g.toggleClass=JSAV.anim(function(c,d,e){var f=b(a(this.element).find("li.jsavindex"),c);return this.jsav._shouldAnimate()?this.jsav.effects._toggleClass(f,d,e):f.toggleClass(d),[c,d,e]}),g.addClass=function(b,c,d){var e=JSAV.utils._helpers.normalizeIndices(a(this.element).find("li.jsavindex"),b,":not(."+c+")");return e.length>0?this.toggleClass(e,c,d):this},g.removeClass=function(b,c,d){var e=JSAV.utils._helpers.normalizeIndices(a(this.element).find("li.jsavindex"),b,"."+c);return e.length>0?this.toggleClass(e,c,d):this},g.hasClass=function(c,d){var e=b(a(this.element).find("li.jsavindex"),c);return e.hasClass(d)},g.isEmpty=function(){for(var a=0;a<this.size();a++)if(""!==this.value(a))return!1;return!0};for(var h=["click","dblclick","mousedown","mousemove","mouseup","mouseenter","mouseleave"],i=function(b){return function(c,d){var e=this;return this.element.on(b,".jsavindex",function(f){var g=e.element.find(".jsavindex").index(this);if(e.jsav.logEvent({type:"jsav-array-"+b,arrayid:e.id(),index:g}),a.isFunction(c))c.call(e,g,f);else if(a.isFunction(d)){var h=a.isArray(c)?c.slice(0):[c];h.unshift(g),h.push(f),d.apply(e,h)}}),this}},j=h.length;j--;)g[h[j]]=i(h[j]);g.on=function(a,b,c){return i(a).call(this,b,c),this},g.toggleArrow=function(a,b){this.toggleClass(a,"jsavarrow",b)},g.toggleLine=JSAV.anim(function(b,c){if("bar"===this.options.layout){var d=this.element.find("li .jsavvalue").eq(b),e=d.parent();if(0!==d.size()){var f=a.extend({startIndex:0,endIndex:this.size()-1},c),g=e.find(".jsavmark"),h=e.find(".jsavmarkline");if(0===h.size()&&0===g.size()){if(null!==f.markStyle&&(g=a("<div class='jsavmark' />"),e.prepend(g),f.markStyle&&g.css(f.markStyle),g.css({bottom:d.height()-g.outerHeight()/2,left:d.position().left+d.width()/2-g.outerWidth()/2,display:"block"})),null!==f.lineStyle){h=a("<div class='jsavmarkline' />"),e.prepend(h),f.lineStyle&&h.css(f.lineStyle);var i=this.element.find("li:eq("+f.startIndex+")"),j=this.element.find("li:eq("+f.endIndex+")");h.css({width:j.position().left-i.position().left+j.width(),left:i.position().left-e.position().left,bottom:d.height()-h.outerHeight()/2,display:"block"})}}else g.remove(),h.remove();return[b,f]}}}),JSAV._types.ds.AVArray=f,JSAV._types.ds.ArrayIndex=d,JSAV.ext.ds.array=function(a,b){return new f(this,a,b)}}}(jQuery),function(a){"use strict";function b(b){var c=0;b.element.find("li").each(function(){c+=a(this).outerWidth(!0)}),c!==b.element.width()&&b.css({width:c+"px"})}function c(c,d){var e=a(c.element).addClass("jsavhorizontalarray"),f=e.find("li"),g=-1;f.each(function(){var b=a(this);g=Math.max(g,b.outerHeight())}),e.height(g+(c.options.indexed?30:0)),b(c,f.last(),d);var h=e.position();return{width:e.outerWidth(),height:e.outerHeight(),left:h.left,top:h.top}}function d(c,d){var e=a(c.element).addClass("jsavverticalarray"),f=e.find("li"),g=-1,h=!!c.options.indexed;h&&(f.each(function(){var b=a(this),c=b.find(".jsavindexlabel");g=Math.max(g,c.innerWidth()),c.css({top:b.innerHeight()/2-c.outerHeight()/2})}),f.css("margin-left",g)),b(c,f.last(),d);var i=e.position();return{width:e.outerWidth(),height:e.outerHeight(),left:i.left,top:i.top}}function e(c,d){for(var e=a(c.element).addClass("jsavbararray"),f=e.find("li.jsavindex"),g=Number.MIN_VALUE,h=(f.first().outerWidth(),c.size()),i=0;h>i;i++)g=Math.max(g,c.value(i));g*=1.15;var j=JSAV.anim(function(a,b,c){var d=a.height();return this.jsav._shouldAnimate()?this.jsav.effects.transition(a,{height:b},c):a.css({height:b}),[a,d]});return f.each(function(b){var d=a(this),e=d.find(".jsavvaluebar"),f=d.find(".jsavvalue"),h=e.height(),i=Math.round(h*(c.value(b)/g));i!==f.height()&&j.call(c,f,i)}),b(c,f.last(),d),{width:c.element.outerWidth(),height:c.element.outerHeight(),left:c.position().left,top:c.position().top}}JSAV.ext.ds.layout.array={_default:c,bar:e,array:c,vertical:d}}(jQuery),function(a){"use strict";function b(b,c,d,e){var f,g,h=c?0:1,i=b.child(c),j=b.child(h),l=a.extend({hide:!0},e);if("undefined"==typeof d)return i&&"jsavnull"!==i.value()?i:void 0;var m=a.extend({},l);if(m.edgeLabel=void 0,null!==d){if(d instanceof k)d.parent()&&d.parent()!==b&&d.remove({hide:!1}),d.parent(b);else{if(i&&("number"==typeof d||"string"==typeof d))return i.value(d,l);d=b.container.newNode(d,b,l)}return d.element.attr("data-binchildrole",c?"right":"left"),g=[],g[c]=d,i&&l.hide&&i.hide(),j?g[h]=j:(f=b.container.newNode("jsavnull",b,m),f.element.addClass("jsavnullnode").attr("data-binchildrole",h?"right":"left"),g[h]=f),b._setchildnodes(g,l),d}return i&&"jsavnull"!==i.value()&&(i.parent(null),j&&"jsavnull"!==j.value()?(f=b.container.newNode("jsavnull",b,m),f.element.addClass("jsavnullnode").attr("data-binchildrole",c?"right":"left"),l.hide&&i.hide(),g=[],g[c]=f,g[h]=j,b._setchildnodes(g,l)):(l.hide&&i.hide(),j&&j.hide(),b._setchildnodes([]))),i}if("undefined"!=typeof JSAV){var c=JSAV._types.ds.Edge,d=function(a,b){this.init(a,b)};JSAV.utils.extend(d,JSAV._types.ds.JSAVDataStructure);var e=d.prototype;e.init=function(b,c){this._layoutDone=!1,this.jsav=b,this.options=c;var d=this.options.element||a("<div/>");d.addClass("jsavtree jsavcommontree");for(var e in this.options){var f=this.options[e];(this.options.hasOwnProperty(e)&&"string"==typeof f||"number"==typeof f||"boolean"==typeof f)&&d.attr("data-"+e,f)}this.options.element||a(this.jsav.canvas).append(d),this.element=d,this.options.autoresize&&this.element.addClass("jsavautoresize"),JSAV.utils._helpers.handlePosition(this),this.rootnode=this.newNode("",null),this.element.attr({"data-root":this.rootnode.id(),id:this.id()}),this.rootnode.element.attr("data-child-role","root"),JSAV.utils._helpers.handleVisibility(this,this.options)},e._setrootnode=JSAV.anim(function(a){var b=this.rootnode;return this.rootnode=a,this.element.attr("data-root",a.id()),a.element.attr("data-child-role","root"),a.element.removeAttr("data-parent data-binchildrole data-child-pos"),b&&b.element.removeAttr("data-child-role"),[b]}),e.root=function(b,c){var d=a.extend({hide:!0},c);if("undefined"==typeof b)return this.rootnode;if(b instanceof f){var e=this.rootnode;this._setrootnode(b,c),this.rootnode.edgeToParent(null),d.hide&&e&&e.hide()}else this.rootnode?this.rootnode.value(b,c):this._setrootnode(this.newNode(b,null,c),c);return this.rootnode},e.clear=function(){this.root().clear(),this.element.remove()},e.newNode=function(a,b,c){return new f(this,a,b,c)},e.height=function(){return this.rootnode.height()},e.layout=function(a){var b=this.options.layout||"_default";return this.jsav.ds.layout.tree[b](this,a)},e.equals=function(a,b){return!a instanceof d?!1:this.root().equals(a.root(),b)},e.css=JSAV.utils._helpers.css,e._setcss=JSAV.anim(JSAV.utils._helpers._setcss),e.show=function(b){0===this.element.filter(":visible").size()&&this._toggleVisible(b);var c=a.extend({recursive:!0},b);return c.recursive&&this.root().show(b),this},e.hide=function(b){this.element.filter(":visible").size()>0&&this._toggleVisible(b);var c=a.extend({recursive:!0},b);return c.recursive&&this.root().hide(b),this},e.state=function(a){if("undefined"==typeof a){var b=function(a){if(!a)return null;var c=a.state(),d=a.children();if(d.length>0){c.children=[];for(var e=0;e<d.length;e++)c.children.push(b(a.child(e)))}return c};return b(this.root())}var c=this,d=function(a,b){a.state(b);for(var e=b.children||[],f=a.children(),g=0,h=e[g],i=f[g];h&&i;)d(i,h),g++,h=e[g],i=f[g];if(e.length>f.length)for(;g<e.length;){var j=c.newNode("",a,{record:!1});a.addChild(j),d(j,e[g]),g++}else for(;g<f.length;)a.child(g).remove({record:!1}),f=a.children()};d(this.root(),a)},JSAV.utils._events._addEventSupport(e);var f=function(a,b,c,d){this.init(a,b,c,d)};JSAV.utils.extend(f,JSAV._types.ds.Node);var g=f.prototype;g.init=function(b,d,e,f){this.jsav=b.jsav,this.container=b,this.parentnode=e,this.options=a.extend(!0,{visible:!0},e?e.options:{},f);var g=this.options.nodeelement||a("<div><span class='jsavvalue'>"+this._valstring(d)+"</span></div>"),h=typeof d;"object"===h&&(h="string"),this.element=g,g.addClass("jsavnode jsavtreenode").attr({"data-value":d,id:this.id(),"data-value-type":h}).data("node",this),e&&g.attr("data-parent",e.id()),this.options.autoResize&&g.addClass("jsavautoresize"),this.container.element.append(g),JSAV.utils._helpers.handleVisibility(this,this.options),e&&(this._edgetoparent=new c(this.jsav,this,e),this.options.edgeLabel&&this._edgetoparent.label(this.options.edgeLabel)),this.childnodes=[]},g._valstring=function(a){var b="<span class='jsavvaluelabel'>";return"jsavnull"===a?b+"</span>":b+a+"</span>"},g._setparent=JSAV.anim(function(a,b){var c=this.parentnode;return this._edgetoparent.end(a,b),b&&b.edgeLabel&&this._edgetoparent.label(b.edgeLabel,b),this.element.attr("data-parent",a?a.id():""),this.parentnode=a,[c,b]}),g.parent=function(a,b){return"undefined"==typeof a?this.parentnode:(this._edgetoparent||this._setEdgeToParent(new c(this.jsav,this,a,b)),this._setparent(a,b))},g._setEdgeToParent=JSAV.anim(function(a,b){var c=this._edgetoparent;return this._edgetoparent=a,[c,b]}),g.edgeToParent=function(a,b){return"undefined"==typeof a?this._edgetoparent:(!a&&this._edgetoparent&&this._edgetoparent.hide(),this._setEdgeToParent(a,b))},g.edgeToChild=function(a){var b=this.child(a);return b?b.edgeToParent():void 0},g.clear=function(){this.edgeToParent()&&this.edgeToParent().clear();for(var a=this.children(),b=a.length;b--;)a[b]&&a[b].clear();this.childnodes=[],this.element.remove()},g.addChild=function(a,b){var c=this.childnodes.length;return this.child(c,a,b)},g._setchildnodes=JSAV.anim(function(b,c){var d=this.childnodes;return this.childnodes=b,a.each(b,function(a,b){b.element.attr("data-child-pos",a)}),[d,c]});var h=function(b,c,d,e){var f=b.childnodes[c],g=a.extend({hide:!0},e);if(f&&(g.hide&&f.hide(),f.parent(null)),d){var h=b.childnodes.slice(0);h[c]=d,d.parent()&&d.parent()!==b&&d.remove({hide:!1}),d.parent(b),b._setchildnodes(h,g)}else b._setchildnodes(a.map(b.childnodes,function(a,b){return b!==c?a:null}),g);return b};g.child=function(a,b,c){return"undefined"==typeof b?this.childnodes[a]:(null===b||b instanceof f||(b=this.container.newNode(b,this,c)),h(this,a,b,c))},g.remove=function(a){if(this===this.container.rootnode)return this.container.root(this.container.newNode("",null),a),this;for(var b=this.parent(),c=b.children(),d=0,e=c.length;e>d;d++)if(c[d]===this)return b.child(d,null,a);return this},g.height=function(){for(var a=this.children(),b=0,c=Math.max,d=0,e=a.length;e>d;d++)a[d]&&(b=c(b,a[d].height()));return b+1},g.equals=function(b,c){if(!b||this.value()!==b.value())return!1;if(c&&"css"in c){var d=JSAV.utils._helpers.cssEquals(this,b,c.css);if(!d)return!1}if(c&&"class"in c){var e=JSAV.utils._helpers.classEquals(this,b,c["class"]);if(!e)return!1}if(this.edgeToParent()){var f=this.edgeToParent().equals(b.edgeToParent(),a.extend({},c,{dontCheckNodes:!0}));if(!f)return!1}var g=this.children(),h=b.children();if(g.length!==h.length)return!1;for(var i=0,j=g.length;j>i;i++)if(g[i]&&h[i]&&!g[i].equals(h[i],c))return!1;return!0},g.children=function(){return this.childnodes},g.show=function(b){0===this.element.filter(":visible").size()&&this._toggleVisible(b);var c=a.extend({recursive:!0},b);if(this._edgetoparent&&this._edgetoparent.show(),c.recursive){var d=this.children();if(d)for(var e=0,f=d.length;f>e;e++)d[e].show(b)}return this},g.hide=function(b){this.element.filter(":visible").size()>0&&this._toggleVisible(b);var c=a.extend({recursive:!0},b);if(this._edgetoparent&&this._edgetoparent.hide(),c.recursive){var d=this.children();if(d)for(var e=0,f=d.length;f>e;e++)d[e].hide(b)}return this};var i=function(a,b){this.init(a,b),this.element.addClass("jsavbinarytree")};JSAV.utils.extend(i,d);var j=i.prototype;j.newNode=function(a,b,c){return new k(this,a,b,c)},j.state=function(a){if("undefined"==typeof a){var b=function(a){if(!a)return null;var c=a.state();return a.left()&&(c.left=b(a.left())),a.right()&&(c.right=b(a.right())),c};return b(this.root())}var c=this,d=function(a,b){a.state(b);var e=function(e){var f=a[e]();if(f||b[e])if(f&&b[e])d(f,b);else if(f)a[e](null,{record:!1});else{var g=c.newNode("",a,{record:!1});a[e](g,{record:!1}),d(g,b[e])}};e("left"),e("right")};d(this.root(),a)};var k=function(a,b,c,d){this.init(a,b,c,d),this.element.addClass("jsavbinarynode")};JSAV.utils.extend(k,f);var l=k.prototype;l.addChild=function(a,b){var c=-1;if(this.left()){if(this.right())return void console.error("Binarytree node already has two children, cannot add more");c=1}else c=0;return this.child(c,a,b)},l.left=function(a,c){return b(this,0,a,c)},l.right=function(a,c){return b(this,1,a,c)},l.child=function(a,c,d){return"undefined"==typeof c?this.childnodes[a]:(("string"==typeof c||"number"==typeof c)&&(c=this.container.newNode(c,this,d)),b(this,a,c,d))},l.remove=function(a){if(this===this.container.rootnode)return this.container.root(this.container.newNode("",null),a),this;var c=this.parent();return c.left()===this?b(c,0,null,a):c.right()===this?b(c,1,null,a):void 0},l.edgeToLeft=function(){return this.edgeToChild(0)},l.edgeToRight=function(){return this.edgeToChild(1)},l._setvalue=JSAV.anim(function(a){var b=this.value(),c=typeof a;return"undefined"==typeof b&&(b=""),"object"===c&&(c="string"),this.element.removeClass("jsavnullnode").find(".jsavvalue").html(this._valstring(a)).end().attr({"data-value":a,"data-value-type":c}),"jsavnull"===a&&this.element.addClass("jsavnullnode"),[b]
});var m=JSAV._types.ds;m.Tree=d,m.TreeNode=f,m.BinaryTree=i,m.BinaryTreeNode=k,JSAV.ext.ds.tree=function(b){return new d(this,a.extend(!0,{visible:!0,autoresize:!0},b))},JSAV.ext.ds.binarytree=function(b){return new i(this,a.extend(!0,{visible:!0,autoresize:!0},b))},JSAV.ext.ds.edge=function(b){return new c(this,a.extend(!0,{},b))}}}(jQuery),function(a){"use strict";function b(b,c){var e=a.extend({},b.options,c),f=e.nodegap||40,g={},h=function(b){return a.map(b,function(a){return a||null})},i=function(a){for(var b=h(a.children()),c=0,d=b.length;d>c;c++)b[c]&&i(b[c]);g[a.id()]={cachedTranslation:{width:0,height:0},translation:{width:0,height:0},node:a},j(a)},j=function(a){var b=h(a.children()),c=g[a.id()],e=a.element.outerWidth()/2,i=a.element.outerHeight();if(0===b.length)c.contours=new d(-e,e+(e%2===0?0:1),i,a.value()),k(a,-e,0);else{var j=0,n=b[0];c.contours=g[n.id()].contours,g[n.id()].contours=null,l(n,0,f+i);for(var o=1,p=b.length;p>o;o++){var q=b[o];if(q){var r=g[q.id()].contours,s=c.contours.calcTranslation(r,f);j+=s,g[q.id()].contours=null,c.contours.joinWith(r,s),l(q,m(n)+s-m(q),f+i)}}var t=j/b.length;c.contours.addOnTop(-e,e+(e%2===0?0:1),i,f,t),k(a,m(n)+t,0)}},k=function(a,b,c){var d=g[a.id()].translation;d.width+=b,d.height+=c},l=function(a,b,c){if(a){var d=g[a.id()].cachedTranslation;d||(d={width:0,height:0},g[a.id()].cachedTranslation=d),d.width+=b,d.height+=c}},m=function(a){var b=g[a.id()].cachedTranslation;return g[a.id()].translation.width+(b?b.width:0)},n=function(a){if(a){var b=g[a.id()];if(b.cachedTranslation){for(var c=h(a.children()),d=0,e=c.length;e>d;d++){var f=c[d];l(f,b.cachedTranslation.width,b.cachedTranslation.height),n(f)}b.translation.width+=b.cachedTranslation.width,b.translation.height+=b.cachedTranslation.height,b.cachedTranslation=null}}},o=b.root();i(o),l(o,20,10+f),n(o);var p=-Number.MAX_VALUE,q=-Number.MAX_VALUE,r=Number.MAX_VALUE,s=Number.MAX_VALUE,t=Math.max,u=Math.min;a.each(g,function(a,b){p=t(p,b.translation.width+b.node.element.outerWidth()),q=t(q,b.translation.height+b.node.element.outerHeight()),r=u(r,b.translation.width),s=u(s,b.translation.height)}),e.boundsOnly||a.each(g,function(a,b){var c=b.node.element.position();b.node._layoutDone||0!==c.left||0!==c.top?b.node.moveTo(b.translation.width-r,b.translation.height-s):(b.node.element.css({left:b.translation.width-r+"px",top:b.translation.height-s+"px"}),b.node._layoutDone=!0)});var v=function(b,c){if(e.hasOwnProperty("center")&&!e.center)return 0;var d=a(b.jsav.canvas).width();return(d-c)/2-b.position().left},w={width:p-r,height:q-s},x=v(b,p-r);return e.boundsOnly||(b._layoutDone?(b.css(w,e),x&&b.translateX(x)):(b._layoutDone=!0,b.element.css(w),x&&b.element.css("left",x)),a.each(g,function(b,c){var d=c.node;if(d._edgetoparent){var f={left:c.translation.width-r,top:c.translation.height-s},h=g[d.parent().id()].translation,i={left:h.width-r,top:h.height-s};d._edgetoparent.layout(a.extend({start:f,end:i},e))}})),a.extend({top:b.position().top},w)}var c=JSAV.ext.ds.layout;c.tree={_default:b};var d=function(a,b,c){this.cHeight=c,this.leftCDims=[],this.leftCDims[this.leftCDims.length]={width:-a,height:c},this.cLeftExtent=a,this.rightCDims=[],this.rightCDims[this.rightCDims.length]={width:-b,height:c},this.cRightExtent=b};d.prototype={addOnTop:function(a,b,c,d,e){var f=this.leftCDims,g=this.rightCDims;f[f.length-1].height+=d,f[f.length-1].width+=e+a,g[g.length-1].height+=d,g[g.length-1].width+=e+b,f.push({width:-a,height:c}),g.push({width:-b,height:c}),this.cHeight+=c+d,this.cLeftExtent-=e,this.cRightExtent-=e,a<this.cLeftExtent&&(this.cLeftExtent=a),b>this.cRightExtent&&(this.cRightExtent=b)},joinWith:function(b,c){var d,e,f;if(b.cHeight>this.cHeight){var g=[],h=b.cHeight-this.cHeight;d=0,e=0,a.each(b.leftCDims,function(a,b){if(h>0){var c={width:b.width,height:b.height};h-=b.height,0>h&&(c.height+=h),g[g.length]=c}else e+=b.width}),f=g[g.length-1],a.each(this.leftCDims,function(a,b){d+=b.width,g[g.length]={width:b.width,height:b.height}}),f.width-=d-e,f.width-=c,this.leftCDims=g}if(b.cHeight>=this.cHeight)this.rightCDims=b.rightCDims.slice();else{var i=this.cHeight-b.cHeight,j=0;d=0,e=0,a.each(this.rightCDims,function(a,b){i>0?(j++,i-=b.height,0>i&&(b.height+=i)):d+=b.width});for(var k=j+1,l=this.rightCDims.length;l>k;k++)this.rightCDims[k]=null;for(this.rightCDims=a.map(this.rightCDims,function(a){return a}),f=this.rightCDims[j],k=0,l=b.rightCDims.length;l>k;k++){var m=b.rightCDims[k];e+=m.width,this.rightCDims[this.rightCDims.length]={width:m.width,height:m.height}}f.width+=d-e,f.width+=c}this.rightCDims[this.rightCDims.length-1].width-=c,b.cHeight>this.cHeight&&(this.cHeight=b.cHeight),b.cLeftExtent+c<this.cLeftExtent&&(this.cLeftExtent=b.cLeftExtent+c),b.cRightExtent+c>this.cRightExtent&&(this.cRightExtent=b.cRightExtent+c)},calcTranslation:function(a,b){for(var c,d,e=this.rightCDims,f=a.leftCDims,g=e.length-1,h=f.length-1,i={width:0,height:0},j={width:0,height:0},k=b;;){if(0>g){if(0>h||j.height>=i.height)break;d=f[h],j.height+=d.height,j.width+=d.width,h--}else if(0>h){if(i.height>=j.height)break;c=e[g],i.height+=c.height,i.width+=c.width,g--}else{c=e[g],d=f[h];var l=i.height,m=j.height;m>=l&&(i.height+=c.height,i.width+=c.width,g--),l>=m&&(j.height+=d.height,j.width+=d.width,h--)}k<j.width-i.width+b&&(k=j.width-i.width+b)}return k}}}(jQuery),function(a){"use strict";function b(b,c){if(b.options.hasOwnProperty("center")&&!b.options.center)return 0;var d=a(b.jsav.canvas).width();return(d-c)/2-b.position().left}if("undefined"!=typeof JSAV){var c=JSAV._types.ds.Edge,d=function(b,c){this.jsav=b,this.options=a.extend({visible:!0,nodegap:40,autoresize:!0},c);var d=this.options.element||a("<div/>");d.addClass("jsavlist");for(var e in this.options){var f=this.options[e];(this.options.hasOwnProperty(e)&&"string"==typeof f||"number"==typeof f||"boolean"==typeof f)&&d.attr("data-"+e,f)}this.options.element||a(b.canvas).append(d),this.element=d,this.element.attr({id:this.id()}),this.options.autoresize&&d.addClass("jsavautoresize"),JSAV.utils._helpers.handlePosition(this),JSAV.utils._helpers.handleVisibility(this,this.options)};JSAV.utils.extend(d,JSAV._types.ds.JSAVDataStructure);var e=d.prototype;e.first=function(a,b){return"undefined"==typeof a?this._first:this.addFirst(a,b)},e._setfirst=JSAV.anim(function(a){var b=this._first;return this._first=a,[b]}),e.add=function(a,b,c){if(0>a||a>this.size())return this;if(0===a)return this.addFirst(b,c);var d,e=this.get(a-1);return d=b instanceof f?b:this.newNode(b),e&&(d.next(e.next(),c),e.next(d,c)),this},e.addFirst=function(b,c){return b instanceof f?(b.next(this._first,c),this._setfirst(b,c)):this._setfirst(this.newNode(b,a.extend({},c,{first:!0,next:this._first})),c),this},e.last=function(a,b){if("undefined"==typeof a){for(var c=this.first();c&&c.next();)c=c.next();return c}this.addLast(a,b)},e.addLast=function(a,b){var c,d=this.last();return"undefined"==typeof d?(this.first(a),this):(c=a instanceof f?a:this.newNode(a),d.next(c,b),this)},e.get=function(a){if(!("number"!=typeof a||0>a)){for(var b=this.first(),c=0;b.next()&&a>c;)b=b.next(),c++;return c===a?b:void 0}},e.newNode=function(b,c){return new f(this,b,a.extend({first:!1},this.options,c))},e.remove=function(b,c){var d=a.extend({hide:!0},c);if(0===b)return this.removeFirst(c);if(b===this.size()-1)return this.removeLast(c);var e=this.get(b-1),f=this.get(b+1),g=e.next();return e.next(f,c),d.hide&&(g.hide(),g.edgeToNext().hide()),g},e.removeFirst=function(b){if(!(this.size()<=0)){var c=a.extend({hide:!0},b),d=this.first();return this._setfirst(d.next(),b),c.hide&&(d.hide(),d.edgeToNext()&&d.edgeToNext().hide()),d}},e.removeLast=function(b){if(this.size()<=1)return this.removeFirst();var c=a.extend({hide:!0},b),d=this.get(this.size()-2),e=this.last();return d.next(null,b),c.hide&&(e.hide(),d.edgeToNext().hide()),e},e.layout=function(b){var c=a.extend({},this.options,b).layout||"_default";return this.jsav.ds.layout.list[c](this,b)},e.state=function(a){if("undefined"==typeof a){for(var b,c={},d=this.first(),e=[],f=[];d;)e.push(d.state()),b=d.edgeToNext(),b&&f.push(b.state()),d=d.next();return c.n=e,c.e=f,c}if(0!==a.n.length){for(var g=this.first(),h=0,i=a.n[h];i&&g;)g.state(i),g=g.next(),i=++h<a.n.length?a.n[h]:null;if(g)for(;g!==this.last();)this.removeLast({record:!1});else for(g=this.last();h<a.n.length;h++){var j=this.newNode("",{record:!1});g||(this.first(j),g=this.first()),j.state(a.n[h]),g.next(j,{record:!1}),g=j}g=this.first();var b=g.edgeToNext(),f=a.e;for(h=0;h<f.length;h++)this.get(h).edgeToNext().state(f[h])}else for(;this.first();)this.removeFirst({record:!1})},e.clear=function(){this.element.remove()},e.size=function(){for(var a=this.first(),b=0;a;)b++,a=a.next();return b},e.equals=function(a,b){return this.first()||a.first()?this.first()?this.first().equals(a.first(),b):!1:!0},e.css=JSAV.utils._helpers.css,e._setcss=JSAV.anim(JSAV.utils._helpers._setcss),JSAV.utils._events._addEventSupport(e);var f=function(b,d,e){this.jsav=b.jsav,this.container=b,this._next=e.next,this._value=d,this.options=a.extend(!0,{visible:!0},e);var f=a("<div><span class='jsavvalue'>"+this._valstring(d)+"</span><span class='jsavpointerarea'></span></div>"),g=typeof d;"object"===g&&(g="string"),this.element=f,f.addClass("jsavnode jsavlistnode").attr({"data-value":d,id:this.id(),"data-value-type":g}).data("node",this),"first"in e&&e.first?this.container.element.prepend(f):this.container.element.append(f),this._next&&(this._edgetonext=new c(this.jsav,this,this._next,{"arrow-end":"classic-wide-long"}),this.options.edgeLabel&&this._edgetonext.label(this.options.edgeLabel)),JSAV.utils._helpers.handleVisibility(this,this.options)};JSAV.utils.extend(f,JSAV._types.ds.Node);var g=f.prototype;g.next=function(a,b){return"undefined"==typeof a?this._next:(this._edgetonext&&this._edgetonext.show(),this._setnext(a,b))},g._setnext=JSAV.anim(function(a,b){var d=this._next;return this._next=a,a&&this._edgetonext?this._edgetonext.end(a):a&&(this._edgetonext=new c(this.jsav,this,this._next,{"arrow-end":"classic-wide-long"})),b&&b.edgeLabel&&this._edgetonext.label(b.edgeLabel),[d]}),g.edgeToNext=function(){return this._edgetonext},g.equals=function(b,c){if(!b||this.value()!==b.value())return!1;if(c&&"css"in c){var d=JSAV.utils._helpers.cssEquals(this,b,c.css);if(!d)return!1}if(c&&"class"in c){var e=JSAV.utils._helpers.classEquals(this,b,c["class"]);if(!e)return!1}if(this.next()&&this.edgeToNext()){var f=this.edgeToNext().equals(b.edgeToNext(),a.extend({},c,{dontCheckNodes:!0}));if(!f)return!1}return this.next()?this.next().equals(b.next(),c):b.next()?!1:!0};var h=JSAV._types.ds;h.List=d,h.ListNode=f;var i=function(a,b,c,d){var e=a.element.position(),f={left:e.left,top:e.top},g={node:a,nodePos:f};d.updateLeft&&(f.left=b?c.left+b.element.outerWidth()+d.nodegap:0),d.updateTop&&(f.top=0);var h=b?b._edgetonext:void 0;return h&&d.updateEdges&&(g.edge=h,g.edgeFromPoint=[c.left+b.element.outerWidth()-5,c.top+Math.round(b.element.outerHeight()/2)]),g},j=function(a,b,c,d){var e=a.element.position(),f={left:e.left,top:e.top},g={node:a,nodePos:f};d.updateLeft&&(f.left=0),d.updateTop&&(f.top=b?c.top+b.element.outerHeight()+d.nodegap:0);var h=b?b._edgetonext:void 0;return h&&d.updateEdges&&(g.edge=h,g.edgeFromPoint=[c.left+Math.round(b.element.outerWidth()/2),c.top+b.element.outerHeight()-5]),g},k=function(c,d,e){for(var f,g,h,i,j,k,l=c.first(),m=a.extend({updateLeft:!0,updateTop:!0,updateEdges:!0},c.options,d),n={},o=Number.MAX_VALUE,p=Number.MAX_VALUE,q=Number.MIN_VALUE,r=Number.MIN_VALUE,s=[];l;)k=e(l,f,n,m),g=k.nodePos,o="undefined"!=typeof g.left?Math.min(g.left,o):o,p="undefined"!=typeof g.top?Math.min(g.top,p):p,q="undefined"!=typeof g.left?Math.max(g.left+l.element.outerWidth(),q):q,r="undefined"!=typeof g.top?Math.max(g.top+l.element.outerHeight(),r):r,s.unshift(k),f=l,n=g,l=l.next();if(c.size())h=q-o,i=r-p;else{var t=c.newNode("");h=t.element.outerWidth(),i=t.element.outerHeight(),t.clear()}if(j=b(c,h,m),!m.boundsOnly){c.css({width:h,height:i}),j&&c.translateX(j);for(var u=s.length-1;u>=0;u--){var v=s[u];v.node.moveTo(v.nodePos.left,v.nodePos.top),v.edge&&v.edge.layout({fromPoint:v.edgeFromPoint,end:v.nodePos})}}return{width:h,height:i,left:j,top:c.element.position().top}},l=function(a,b){return a.element.addClass("jsavverticallist"),k(a,b,j)},m=function(a,b){return a.element.addClass("jsavhorizontallist"),k(a,b,i)};JSAV.ext.ds.layout.list={_default:m,horizontal:m,vertical:l},JSAV.ext.ds.list=function(a){return new d(this,a)}}}(jQuery),function(a){"use strict";if("undefined"!=typeof JSAV){var b=JSAV._types.ds.Edge,c=function(b,c){this._nodes=[],this._edges=[],this._alledges=null,this.jsav=b,this.options=a.extend({visible:!0,nodegap:40,autoresize:!0,width:400,height:200,directed:!1,center:!0},c);var d=this.options.element||a("<div/>");d.addClass("jsavgraph");for(var e in this.options){var f=this.options[e];(this.options.hasOwnProperty(e)&&"string"==typeof f||"number"==typeof f||"boolean"==typeof f)&&d.attr("data-"+e,f)}this.options.element||a(b.canvas).append(d),this.element=d,d.attr({id:this.id()}).width(this.options.width).height(this.options.height),this.options.autoresize&&d.addClass("jsavautoresize"),this.options.center&&d.addClass("jsavcenter"),JSAV.utils._helpers.handlePosition(this),JSAV.utils._helpers.handleVisibility(this,this.options)};c._nodeSortFunction=function(a,b){return a.value()<b.value()},JSAV.utils.extend(c,JSAV._types.ds.JSAVDataStructure);var d=c.prototype;d.css=JSAV.utils._helpers.css,d._setcss=JSAV.anim(JSAV.utils._helpers._setcss),d._setnodes=JSAV.anim(function(a,b){var c=this._nodes;return this._nodes=a,[c,b]}),d._setadjs=JSAV.anim(function(a,b){var c=this._edges;return this._edges=a,this._alledges=null,[c,b]}),d._setadjlist=JSAV.anim(function(a,b,c){var d=this._edges[b];return this._edges[b]=a,this._alledges=null,[d,b,c]}),d.newNode=function(a,b){var c=new j(this,a,b),d=this._nodes.slice(0);d.push(c),this._setnodes(d,b);var e=this._edges.slice(0);return e.push([]),this._setadjs(e,b),c},d.addNode=function(a,b){return this.newNode(a,b)},d.removeNode=function(a,b){var c=this._nodes.indexOf(a);if(-1!==c){for(var d=this.edges(),e=d.length;e--;){var f=d[e];(f.start().id()===a.id()||f.end().id()===a.id())&&this.removeEdge(f,b)}var g=this._edges.slice(0,c),h=g.concat(this._edges.slice(c+1));this._setadjs(h,b);var i=this._nodes.slice(0,c),j=i.concat(this._nodes.slice(c+1));return this._setnodes(j,b),a.hide(b),this}},d.addEdge=function(c,d,e){if(!this.hasEdge(c,d)){var f=a.extend({},this.options,e);f.directed&&!f["arrow-end"]&&(f["arrow-end"]="classic-wide-long");var g=this._nodes.indexOf(c),h=this._nodes.indexOf(d);if(-1!==g&&-1!==h){var i=new b(this.jsav,c,d,f),j=this._edges[g].slice(0);return j.push(i),this._setadjlist(j,g,f),i}}},d.removeEdge=function(a,b,c){var d,e,f,g;if(a.constructor===JSAV._types.ds.Edge?(d=a,e=d.start(),f=d.end(),g=b):(e=a,f=b,d=this.getEdge(e,f),g=c),d){var h=this._nodes.indexOf(e),i=(this._nodes.indexOf(f),this._edges[h]),j=i.indexOf(d),k=i.slice(0,j).concat(i.slice(j+1));this._setadjlist(k,h,c),d.hide()}},d.hasEdge=function(a,b){return this.getEdge(a,b)},d.getEdge=function(a,b){for(var c=this.edges(),d=0,e=c.length;e>d;d++){var f=c[d];if(f.start()===a&&f.end()===b)return f;if(!this.options.directed&&f.end()===a&&f.start()===b)return f}return void 0},d.nodes=function(){return JSAV.utils.iterable(this._nodes)},d.nodeCount=function(){return this._nodes.length};var e=function(a){for(var b=[],c=0,d=a._edges.length;d>c;c++)for(var e=0,f=a._edges[c].length;f>e;e++){var g=a._edges[c][e];-1===b.indexOf(g)&&b.push(g)}return b};d.edges=function(){return this._alledges||(this._alledges=e(this)),JSAV.utils.iterable(this._alledges)},d.edgeCount=function(){return this._alledges||(this._alledges=e(this)),this._alledges.length},d.equals=function(a,b){if(!a instanceof c)return!1;if(this.nodeCount()!==a.nodeCount()||this.edgeCount()!==a.edgeCount())return!1;for(var d=this.nodes().sort(c._nodeSortFunction),e=a.nodes().sort(c._nodeSortFunction),f=d.length;f--;)if(!d[f].equals(e[f],b))return!1;return!0},d.clone=function(b){var d=a.extend(this.options,{visible:!1},b);"element"in d&&delete d.element;var e,f,g,h,i,j,k,l,m=this.jsav.ds.graph(d),n=this.nodes(c._nodeSortFunction),o=this.edges();for(i=0;i<n.length;i++)g=n[i],e=m.addNode(g.value(),d),e.element.attr("style",g.element.attr("style")),e.element.attr("class",g.element.attr("class"));for(f=m.nodes(c._nodeSortFunction),i=0;i<o.length;i++)h=o[i],j=n.indexOf(h.start()),k=n.indexOf(h.end()),l="undefined"!=typeof h.weight()?{weight:h.weight()}:{},m.addEdge(f[j],f[k],a.extend({},d,l));return m},d.state=function(a){if("undefined"==typeof a){var b,d,e={},f=[],g=[],h=this.nodes(c._nodeSortFunction),i=this.edges();for(b=0;b<h.length;b++)f.push(h[b].state());for(b=0;b<i.length;b++)d=i[b],g.push([h.indexOf(d.start()),h.indexOf(d.end()),d.state()]);return e.n=f,e.e=g,e}var b,j,d,k,g=this.edges(),f=this.nodes(c._nodeSortFunction),l=a.n,m=a.e;for(b=0,j=g.length;j>b;b++)d=g[b],this.removeEdge(d.start(),d.end(),{record:!1});for(b=0;b<f.length&&b<l.length;b++)f[b].state(l[b]);for(;b<f.length;)this.removeNode(f[f.length-1]),b++;for(;b<l.length;){var n=this.newNode("",{record:!1});n.state(l[f.length]),f.push(n),b++}for(b=0,j=m.length;j>b;b++)d=m[b],k=this.addEdge(f[d[0]],f[d[1]],{record:!1}),k.state(d[2])},JSAV.utils._events._addEventSupport(d),d.layout=function(a){var b=this.options.layout||"_default";return this.jsav.ds.layout.graph[b](this,a)};var f=function(a,b){this.graph=a,this.iterations=2e3,this.maxRepulsiveForceDistance=6,this.k=2,this.c=.01,this.maxVertexMovement=.5,this.results={},this.nodes=a.nodes(),this.edges=a.edges(),this.layout();for(var c,d,e,f=(a.element.width()-this.maxNodeWidth)/(this.layoutMaxX-this.layoutMinX),g=(a.element.height()-this.maxNodeHeight)/(this.layoutMaxY-this.layoutMinY),h=0,i=this.nodes.length;i>h;h++)c=this.nodes[h],e=this.results[c.id()],c.moveTo((e.layoutPosX-this.layoutMinX)*f,Math.max(0,(e.layoutPosY-this.layoutMinY)*g-c.element.outerHeight()));for(h=0,i=this.edges.length;i>h;h++)d=this.edges[h],d.layout(b)};/*!
   * Graph layout algorithm based on Graph Dracula
   * https://github.com/strathausen/dracula
   * Graph Dracula is "released under the MIT license"
   */
f.prototype={layout:function(){this.layoutPrepare();for(var a=0;a<this.iterations;a++)this.layoutIteration();this.layoutCalcBounds()},layoutPrepare:function(){for(var a=0,b=this.nodes.length;b>a;a++){var c={};c.layoutPosX=0,c.layoutPosY=0,c.layoutForceX=0,c.layoutForceY=0,this.results[this.nodes[a].id()]=c}},layoutCalcBounds:function(){var a,b,c,d,e,f=1/0,g=-1/0,h=1/0,i=-1/0,j=this.nodes,k=-1/0,l=-1/0;for(a=0,d=j.length;d>a;a++)e=j[a],b=this.results[e.id()].layoutPosX,c=this.results[e.id()].layoutPosY,b>g&&(g=b),f>b&&(f=b),c>i&&(i=c),h>c&&(h=c),k=Math.max(k,e.element.outerWidth()),l=Math.max(l,e.element.outerHeight());this.layoutMinX=f,this.layoutMaxX=g,this.layoutMinY=h,this.layoutMaxY=i,this.maxNodeWidth=k,this.maxNodeHeight=l},layoutIteration:function(){var a,b,c,d,e,f,g=[];for(a=this.nodes,c=0,d=a.length;d>c;c++){var h=a[c];for(e=0,f=g.length;f>e;e++){var i=a[g[e]];this.layoutRepulsive(h,i)}g.push(c)}for(b=this.edges,c=0,d=b.length;d>c;c++){var j=b[c];this.layoutAttractive(j)}for(a=this.nodes,c=0,d=a.length;d>c;c++){var k=this.results[a[c].id()],l=this.c*k.layoutForceX,m=this.c*k.layoutForceY,n=this.maxVertexMovement;l>n&&(l=n),-n>l&&(l=-n),m>n&&(m=n),-n>m&&(m=-n),k.layoutPosX+=l,k.layoutPosY+=m,k.layoutForceX=0,k.layoutForceY=0}},layoutRepulsive:function(a,b){if("undefined"!=typeof a&&"undefined"!=typeof b){var c=this.results[a.id()],d=this.results[b.id()],e=d.layoutPosX-c.layoutPosX,f=d.layoutPosY-c.layoutPosY,g=e*e+f*f;.01>g&&(e=.1*Math.random()+.1,f=.1*Math.random()+.1,g=e*e+f*f);var h=Math.sqrt(g);if(h<this.maxRepulsiveForceDistance){var i=this.k*this.k/h;d.layoutForceX+=i*e/h,d.layoutForceY+=i*f/h,c.layoutForceX-=i*e/h,c.layoutForceY-=i*f/h}}},layoutAttractive:function(a){var b=a.start(),c=a.end(),d=this.results[b.id()],e=this.results[c.id()],f=e.layoutPosX-d.layoutPosX,g=e.layoutPosY-d.layoutPosY,h=f*f+g*g;.01>h&&(f=.1*Math.random()+.1,g=.1*Math.random()+.1,h=f*f+g*g);var i=Math.sqrt(h);i>this.maxRepulsiveForceDistance&&(i=this.maxRepulsiveForceDistance,h=i*i);var j=(h-this.k*this.k)/this.k;void 0===a.attraction&&(a.attraction=1),j*=.5*Math.log(a.attraction)+1,e.layoutForceX-=j*f/i,e.layoutForceY-=j*g/i,d.layoutForceX+=j*f/i,d.layoutForceY+=j*g/i}};/*! End Graph Dracula -based code
  */
var g=function(a){new f(a)},h=function(a){var b,c,d,e=a.edges();for(b=0,c=e.length;c>b;b++)d=e[b],d.layout()};JSAV.ext.ds.layout.graph={_default:h,automatic:g,manual:h};var i=function(b,c){if(!("dagre"in window))return void console.error("You are trying to use the layered layout, please load dagre.js (https://github.com/cpettitt/dagre)!");for(var d=a.extend({},b.options,c),e=new dagre.Digraph,f=b.nodes(),g={};f.hasNext();){var h=f.next();g[h.id()]=h,e.addNode(h.id(),{width:h.bounds().width,height:h.bounds().height})}for(var i=b.edges();i.hasNext();){var j=i.next();e.addEdge(null,j.start().id(),j.end().id())}var k=dagre.layout().run(e),l=-1,m=-1;k.eachNode(function(a,b){d.boundsOnly||g[a].moveTo(b.x-b.width/2,b.y-b.height/2),l=Math.max(b.x+b.width,l),m=Math.max(b.y+b.height,m)});var n={width:l+5,height:m+5};if(!d.boundsOnly)for(b.css(n),i=b.edges();i.hasNext();)j=i.next(),j.layout();return a.extend({top:b.position().top},n)};JSAV.ext.ds.layout.graph.layered=i;var j=function(b,c,d){this.jsav=b.jsav,this.container=b,this.options=a.extend(!0,{visible:!0,left:0,top:0},d);var e=this.options.nodeelement||a("<div><span class='jsavvalue'>"+this._valstring(c)+"</span></div>"),f=typeof c;"object"===f&&(f="string"),this.element=e,e.addClass("jsavnode jsavgraphnode").attr({"data-value":c,id:this.id(),"data-value-type":f}).data("node",this),this.options.autoResize&&e.addClass("jsavautoresize"),this.container.element.append(e),JSAV.utils._helpers.handlePosition(this),JSAV.utils._helpers.handleVisibility(this,this.options)};JSAV.utils.extend(j,JSAV._types.ds.Node);var k=j.prototype;k.css=JSAV.utils._helpers.css,k._setcss=JSAV.anim(JSAV.utils._helpers._setcss),k.neighbors=function(){var a,b,c,d,e=[];if(this.container.options.directed)for(a=this.container._edges[this.container._nodes.indexOf(this)],c=0,d=a.length;d>c;c++)e.push(a[c].end());else for(a=this.container.edges(),c=0,d=a.length;d>c;c++)b=a[c],b.start()===this?e.push(b.end()):b.end()===this&&e.push(b.start());return JSAV.utils.iterable(e)},k.edgeTo=function(a){return this.container.getEdge(this,a)},k.edgeFrom=function(a){return a.edgeTo(this)},k.equals=function(b,d){if(!b||this.value()!==b.value())return!1;if(d&&"css"in d){var e=JSAV.utils._helpers.cssEquals(this,b,d.css);if(!e)return!1}if(d&&"class"in d){var f=JSAV.utils._helpers.classEquals(this,b,d["class"]);if(!f)return!1}var g,h,i=this.neighbors().sort(c._nodeSortFunction),j=b.neighbors().sort(c._nodeSortFunction);if(i.length!==j.length)return!1;var k;for(k=i.length;k--;){if(g=i[k],h=j[k],g.value()!==h.value())return!1;if(!this.container.getEdge(this,g).equals(b.container.getEdge(b,h),a.extend({},d,{dontCheckNodes:!0})))return!1}return!0};var l=JSAV._types.ds;l.Graph=c,l.GraphNode=j,JSAV.ext.ds.graph=function(b){return new c(this,a.extend(!0,{visible:!0,autoresize:!0},b))}}}(jQuery),function(a){"use strict";if("undefined"!=typeof JSAV){var b=(JSAV.utils._helpers.getIndices,{style:"table",autoresize:!0,center:!0,visible:!0}),c=function(c,d,e){this.jsav=c;var f;if(a.isArray(d))this.options=a.extend({},b,e),e=this.options;else if("object"==typeof d){this.options=a.extend({},b,d),e=this.options;var g=[];for(d=[],g.length=e.columns,f=e.rows;f--;)d.push(g)}else console.error("Invalid arguments for initializing a matrix!");this.element=e.element?a(e.element):a("<div class='jsavmatrix' />").appendTo(c.canvas),"id"in e&&this.id(e.id,{record:!1}),this.element.addClass("jsavmatrix"+e.style);var h,i=a.extend({},e,{center:!1,visible:!1});for(delete i.id,delete i.left,delete i.top,delete i.relativeTo,this._arrays=[],f=0;f<d.length;f++)h=a("<ol />"),i.element=h,this.element.append(h),this._arrays[f]=c.ds.array(d[f],i),h.css("display","block");this.options=a.extend(!0,{},e),JSAV.utils._helpers.handlePosition(this),this.layout(),JSAV.utils._helpers.handleVisibility(this,this.options)};JSAV.utils.extend(c,JSAV._types.ds.JSAVDataStructure);var d=c.prototype;d.swap=function(a,b,c,d,e){return this.jsav.effects.swapValues(this._arrays[a],b,this._arrays[c],d,e),this},d.state=function(a){var b,c,d=this._arrays;if(a){for(b=0,c=d.length;c>b;b++)d[b].state(a[b]);return this}var e=[];for(b=0,c=d.length;c>b;b++)e.push(d[b].state());return e},d.layout=function(a){var b,c,d=this._arrays.length,e=-1;for(this.options.center&&this.element.addClass("jsavcenter"),c=0;d>c;c++)b=this._arrays[c].layout(a),e=Math.max(e,b.width);this.element.width(e+"px")},d.equals=function(b,d){var e,f,g;if(a.isArray(b)){for(e=b.length;e--;)if(!this._arrays[e].equals(b[e],d))return!1}else{if(b.constructor!==c)return console.error("Unknown type of object for comparing with matrix:",b),!1;if(f=this._arrays,g=b._arrays,g.length!==f.length)return!1;for(e=g.length;e--;)if(!f[e].equals(g[e],d))return!1}return!0};for(var e=["highlight","unhighlight","isHighlight","css","value","addClass","hasClass","removeClass","toggleClass"],f=function(a){return function(){var b=arguments[0];if("number"==typeof b){var c=this._arrays[b];return c[a].apply(c,[].slice.call(arguments,1))}}},g=e.length;g--;)d[e[g]]=f(e[g]);var h=["click","dblclick","mousedown","mousemove","mouseup","mouseenter","mouseleave"],i=function(b){return function(c,d){var e=this;return this.element.on(b,".jsavindex",function(f){var g=a(this).parent(),h=e.element.find(".jsavarray").index(g),i=g.find(".jsavindex").index(this);if(e.jsav.logEvent({type:"jsav-matrix-"+b,matrixid:e.id(),row:h,column:i}),a.isFunction(c))c.call(e,h,i,f);else if(a.isFunction(d)){var j=a.isArray(c)?c.slice(0):[c];j.unshift(i),j.unshift(h),j.push(f),d.apply(e,j)}}),this}};for(g=h.length;g--;)d[h[g]]=i(h[g]);d.on=function(a,b,c){return i(a).call(this,b,c),this},JSAV._types.ds.Matrix=c,JSAV.ext.ds.matrix=function(a,b){return new c(this,a,b)}}}(jQuery),function(a){"use strict";function b(b,d){"string"==typeof d&&(d=b.options.tags&&"undefined"!=typeof b.options.tags[d]?b.options.tags[d]:void 0);var e;if(d)if("number"==typeof d)e=d-1;else if(a.isArray(d)){e=[];for(var f=0;f<d.length;f++)e[f]=d[f]-1}else a.isFunction(d)&&(e=function(a){return d(a+1)});return c(a(b.element).find("li.jsavcodeline"),e)}if("undefined"!=typeof JSAV){var c=JSAV.utils._helpers.getIndices,d=function(b,c,d){this.jsav=b,this.options=a.extend({visible:!1,type:typeof c},d),this.element=a('<div class="jsavvariable"><span class="jsavvarlabel"></span> <span class="jsavvalue"><span class="jsavvaluelabel jsavvarvalue">'+c+"</span></span></div>"),this.element.find(".jsavvarvalue").attr("data-value",c),this.element.data("var",this),this.options.before?this.element.insertBefore(this.options.before.element):this.options.after?this.element.insertAfter(this.options.after.element):a(this.jsav.canvas).append(this.element),this.options.label&&this.element.find(".jsavvarlabel").html(this.options.label),this.options.name&&this.element.attr("data-varname",this.options.name),JSAV.utils._helpers.handlePosition(this),JSAV.utils._helpers.handleVisibility(this,this.options)};JSAV.utils.extend(d,JSAV._types.JSAVObject);var e=d.prototype;e._toggleVisible=JSAV.anim(JSAV.ext.effects._toggleVisible),e.show=JSAV.ext.effects.show,e.hide=JSAV.ext.effects.hide,JSAV.utils._events._addEventSupport(e,{selector:".jsavvalue",logEventPrefix:"jsav-var-",dataField:"var"}),e._setValue=JSAV.anim(function(a,b){var c=this.value();return this.element.find(".jsavvarvalue").html(a),this.element.find(".jsavvarvalue").attr("data-value",a),[c,b]}),e.value=function(a,b){if("undefined"==typeof a){var c=this.element.find(".jsavvarvalue").attr("data-value");return JSAV.utils.value2type(c,this.options.type)}return this._setValue(a,b),this},e.state=function(a){if(!a){var b={t:this.options.type,v:this.value()},c=JSAV.utils._helpers.elementClasses(this.element),d=this.element.attr("style");return d&&(b.style=d),c.length>0&&(b.cls=c),b}this.options.type=a.t,this.value(a.v,{record:!1}),JSAV.utils._helpers.setElementClasses(this.element,a.cls||[]),this.element.attr("style",a.style||"")},e.equals=function(a,b){if(!a||"object"!=typeof a||this.value()!==a.value())return!1;if(b&&"css"in b){var c=JSAV.utils._helpers.cssEquals(this,a,b.css);if(!c)return!1}if(b&&"class"in b){var d=JSAV.utils._helpers.classEquals(this,a,b["class"]);if(!d)return!1}return!0},e.css=JSAV.utils._helpers.css,e._setcss=JSAV.anim(JSAV.utils._helpers._setcss),e.addClass=JSAV.utils._helpers.addClass,e.removeClass=JSAV.utils._helpers.removeClass,e.hasClass=JSAV.utils._helpers.hasClass,e.toggleClass=JSAV.anim(JSAV.utils._helpers._toggleClass),e.highlight=function(a){this.addClass("jsavhighlight",a)},e.unhighlight=function(a){this.removeClass("jsavhighlight",a)},e.isHighlight=function(){return this.hasClass("jsavhighlight")},JSAV._types.Variable=d,JSAV.ext.variable=function(a,b){return new d(this,a,b)};var f=function(b,c,d){this.jsav=b;var e={visible:!0,follow:!0,anchor:"left top",myAnchor:"left bottom",left:0,top:"-20px"};if(this.options=a.extend(e,d),this.element=a('<div class="jsavpointer"><div class="jsavlabel">'+c+'</div><div class="jsavpointerarea"></div></div>'),this.options.before?this.element.insertBefore(this.options.before.element):this.options.after?this.element.insertAfter(this.options.after.element):this.options.container?this.options.container.append(this.element):a(this.jsav.canvas).append(this.element),"undefined"!=typeof this.options.targetIndex?(this.options.relativeTo=this.options.relativeTo.index(this.options.targetIndex),delete this.options.targetIndex,delete this.options.relativeIndex):"undefined"!=typeof this.options.relativeIndex&&(this.options.relativeTo=this.options.relativeTo.index(this.options.relativeIndex),delete this.options.relativeIndex),!this.options.fixed){this.options.follow=!0;var f=this,g=function(a,b){f._pointerLeftSum+=a,f._pointerTopSum+=b};this._arrowPointerCallback=g}JSAV.utils._helpers.setRelativePositioning(this,a.extend({},this.options,{callback:this._arrowPointerCallback})),JSAV.utils._helpers.handleVisibility(this,this.options),this._target=this.options.relativeTo,this._target&&this._createArrow()};JSAV.utils.extend(f,JSAV._types.Label);var g=f.prototype;g._setArrowTargetFollower=function(){this._targetLeftSum=0,this._targetTopSum=0;var a=this;if(!this._arrowUpdateRelativeListener){var b=function(){a.isVisible()&&(a._translateArrowPoints(a._pointerLeftSum,a._pointerTopSum,a._targetLeftSum,a._targetTopSum),a._targetLeftSum=0,a._targetTopSum=0,a._pointerLeftSum=0,a._pointerTopSum=0)};this._arrowUpdateRelativeListener=b,a.jsav.container.on("jsav-updaterelative",b)}var c=function(b,c){a._targetLeftSum+=b,a._targetTopSum+=c};JSAV.utils._helpers._setRelativeFollowUpdater(this.arrow,this._target,{callback:c,autotranslate:!1})},g._translateArrowPoints=function(a,b,c,d){var e=this.arrow.points();e[0][0]+=a,e[0][1]+=b,e[1][0]+=c,e[1][1]+=d,this.arrow.movePoints([[0,e[0][0],e[0][1]],[1,e[1][0],e[1][1]]])},g._createArrow=function(){var a=this._arrowPoints(),b=this.jsav.g.line(a[0][1],a[0][2],a[1][1],a[1][2],{"arrow-end":"classic-wide","arrow-start":"oval-medium-medium","stroke-width":2,opacity:0});this.isVisible()&&b.show(),this._pointerLeftSum=0,this._pointerTopSum=0,this.arrow=b,this._setArrowTargetFollower()},g._setTarget=JSAV.anim(function(a){var b=this.target();return this._target=a,[b]}),g._arrowPoints=function(b,c,d){"object"==typeof b&&(d=b,b=null,c=null);var e=a.extend({},this.options,d),f=this.bounds(),g=this._calculateArrowTargetPosition(this._target,e),h=[[0,(b||f.left)+f.width/2+1,(c||f.top)+f.height-5],[1,g[0],g[1]]];return h},g._calculateArrowTargetPosition=function(a,b){var c=this.bounds();if(null===this._target)return[c.left+c.width/2+5,c.top+c.height+5];var d={left:0,center:50,right:100},e={top:0,center:50,bottom:100},f=50,g=0,h=b.arrowAnchor||this.options.arrowAnchor;if(h){var i=h.split(" ");1===i.length?f=g=parseInt(i[0],10):(f=d[i[0]],"number"!=typeof f&&(f=parseInt(i[0],10)),g=e[i[1]],"number"!=typeof g&&(g=parseInt(i[1],10)))}var j=a.element,k=j.offset(),l=this.jsav.canvas.offset(),m={width:j.outerWidth(),height:j.outerHeight(),left:k.left-l.left,top:k.top-l.top};return[m.left+m.width*f/100,m.top+m.height*g/100]},g.target=function(b,c){if("undefined"==typeof b)return this._target;var d=a.extend({},c);if("undefined"!=typeof d.targetIndex?(b=b.index(d.targetIndex),delete d.targetIndex,delete d.relativeIndex):"undefined"!=typeof d.relativeIndex&&(b=b.index(d.relativeIndex),delete d.relativeIndex),this._setTarget(b,d),null===b)return this.arrow&&this.arrow.hide(),this.addClass("jsavnullpointer"),this;if(this.removeClass("jsavnullpointer"),this.arrow?this.arrow.isVisible()||this.arrow.show():this._createArrow(d),this._pointerLeftSum=0,this._pointerTopSum=0,!this.options.fixed){JSAV.utils._helpers.setRelativePositioning(this,a.extend({},this.options,d,{relativeTo:b,callback:this._arrowPointerCallback}))}this._setArrowTargetFollower();var e=this._calculateArrowTargetPosition(b,d),f=this.arrow.points()[1];return this._targetLeftSum+=e[0]-f[0],this._targetTopSum+=e[1]-f[1],this},g._orighide=g.hide,g.hide=function(a){this._orighide(a),this.arrow&&this.arrow.hide()},g._origshow=g.show,g.show=function(a){this._origshow(a),this.arrow&&this.arrow.show()},g.equals=function(a,b){if(!a||!a instanceof f)return!1;if(b&&"css"in b){var c=JSAV.utils._helpers.cssEquals(this,a,b.css);if(!c)return!1}if(b&&"class"in b){var d=JSAV.utils._helpers.classEquals(this,a,b["class"]);if(!d)return!1}return this.target().equals(a.target(),b)},JSAV.ext.pointer=function(b,c,d){return new f(this,b,a.extend({},d,{relativeTo:c}))},JSAV._types.Pointer=f;var h=/\s+$/,i=/^\s*\n/,j=function(b,c,d){this.jsav=b,"undefined"==typeof c?c=[]:"string"==typeof c?c=c.split("\n"):"object"!=typeof c||a.isArray(c)||(d=c,a.ajax({url:d.url,async:!1,mimeType:"text/plain",success:function(a){var b,e=a;d.startAfter&&(b=e.split(d.startAfter),e=b[b.length-1]),d.endBefore&&(e=e.split(d.endBefore)[0]),e=e.replace(h,"").replace(i,""),c=e.split("\n")}})),this.options=a.extend({visible:!0,lineNumbers:!0,htmlEscape:!0,center:!0},d);var e=this.options.lineNumbers?"ol":"ul";this.element=this.options.element||a("<"+e+' class="jsavcode"></'+e+">"),this.options.before?this.element.insertBefore(this.options.before.element):this.options.after?this.element.insertAfter(this.options.after.element):a(this.jsav.canvas).append(this.element);for(var f=a(),g=0,j=c.length;j>g;g++)f=f.add(k(c[g],this));if(this.element.append(f),JSAV.utils._helpers.handlePosition(this),JSAV.utils._helpers.handleVisibility(this,this.options),this.options.center&&!this.options.left&&!this.options.right&&!this.options.top&&!this.options.bottom){var l=this.element.css("display");this.element.css("display","inline-block"),this.element.css("width",this.element.outerWidth()),this.element.css("display",l),this.element.addClass("jsavcenter")}},k=function(b,c){var d=a('<li class="jsavcodeline">');return c.options.htmlEscape?d.text(b):d.html(b),d};JSAV.utils.extend(j,JSAV._types.JSAVObject);var l=j.prototype;l._toggleVisible=JSAV.anim(JSAV.ext.effects._toggleVisible),l.addCodeLine=JSAV.anim(function(a){this.element.append(k(a,this))}),l.highlight=function(a){return this.addClass(a,"jsavhighlight")},l.unhighlight=function(a){return this.removeClass(a,"jsavhighlight")},l.isHighlight=function(a){return this.hasClass(a,"jsavhighlight")},l.toggleClass=JSAV.anim(function(a,c,d){var e=b(this,a);return this.jsav._shouldAnimate()?this.jsav.effects._toggleClass(e,c,d):e.toggleClass(c),[a,c]}),l.addClass=function(a,c,d){var e=b(this,a);return e.hasClass(c)?this:this.toggleClass(a,c,d)},l.removeClass=function(a,c,d){var e=b(this,a);return e.hasClass(c)?this.toggleClass(a,c,d):this},l.hasClass=function(a,c){var d=b(this,a);return d.hasClass(c)},l._setcss=JSAV.anim(function(a,c,d){var e=b(this,a);return this.jsav._shouldAnimate()?this.jsav.effects.transition(e,c,d):e.css(c),this}),l.setCurrentLine=function(a,b){var c=this.element.find("li.jsavcurrentline"),d=this.element.find("li.jsavcodeline").index(c)+1,e=this.element.find("li.jsavpreviousline"),f=this.element.find("li.jsavcodeline").index(e)+1;return"string"==typeof a&&(a=this.options.tags&&"undefined"!=typeof this.options.tags[a]?this.options.tags[a]:0),0===a?(0!==d&&this.toggleClass(d,"jsavcurrentline"),0!==f&&this.toggleClass(f,"jsavpreviousline")):0===f&&0===d?this.toggleClass(a,"jsavcurrentline"):0===f&&0!==d&&a!==d?(this.toggleClass(d,"jsavpreviousline jsavcurrentline",b),this.toggleClass(a,"jsavcurrentline")):0!==f&&0!==d&&a!==d&&a!==f&&f!==d?(this.toggleClass(f,"jsavpreviousline",b),this.toggleClass(d,"jsavpreviousline jsavcurrentline",b),this.toggleClass(a,"jsavcurrentline",b)):f===a&&d===a||(0!==f&&0!==d&&a===f?(this.toggleClass(f,"jsavpreviousline jsavcurrentline",b),this.toggleClass(d,"jsavpreviousline jsavcurrentline",b)):0!==f&&0!==d&&a===d?(this.toggleClass(f,"jsavpreviousline",b),this.toggleClass(d,"jsavpreviousline",b)):0!==f&&0!==d&&d===f&&(this.toggleClass(f,"jsavcurrentline",b),this.toggleClass(a,"jsavcurrentline",b))),this},l.css=function(c,d,e){var f=b(this,c);if("string"==typeof d)return f.css(d);if("string"==typeof c&&"undefined"==typeof d)return this.element.css(c);if(a.isFunction(c)){for(var g=a(this.element).find("li.jsavcodeline"),h=[],i=0;i<f.size();i++)h.push(g.index(f[i])+1);c=h}return this._setcss(c,d,e)},l.show=function(b,c){return"undefined"!=typeof b&&"object"!=typeof b||a.isArray(b)||0!==this.element.filter(":visible").size()?this.removeClass(b,"jsavhiddencode",c):this._toggleVisible(b)},l.hide=function(b,c){return"undefined"!=typeof b&&"object"!=typeof b||a.isArray(b)||1!==this.element.filter(":visible").size()?this.addClass(b,"jsavhiddencode",c):this._toggleVisible(b)},l.state=function(a){return"undefined"==typeof a?{html:this.element.html()}:void this.element.html(a.html)},JSAV._types.Code=j,JSAV.ext.code=function(a,b){return new j(this,a,b)}}}(jQuery),function(a){"use strict";if("undefined"!=typeof JSAV){var b=[5e3,3e3,1500,1e3,500,400,300,200,100,50],c=function(a){for(var c=b.length-1;c&&b[c]<a;)c--;return c+1},d=function(d){return function(){var e;if(d.jsav)e=d.jsav._translate;else{var f="en";window.JSAV_OPTIONS&&window.JSAV_OPTIONS.lang&&"object"==typeof JSAV._translations[window.JSAV_OPTIONS.lang]&&(f=window.JSAV_OPTIONS.lang),e=JSAV.utils.getInterpreter(JSAV._translations,f)}var g=JSAV.ext.SPEED,h=!!a.support.inputTypeRange,i=c(g),j=a('<div class="jsavrow">'+e("animationSpeed")+(h?" "+e("(slowFast)"):"")+': <input type="range" min="1" max="10" step="1" size="30" value="'+i+'"/> '+(h?"":"<button>"+e("save")+'</button><div class="jsavhelp">'+e("valueBetween1And10"))+"</div>"),k=function(){var c=parseInt(a(this).val(),10);isNaN(c)||1>c||c>10||(c=b[c-1],g=c,JSAV.ext.SPEED=c,a(document).trigger("jsav-speed-change",c),localStorage&&localStorage.setItem("jsav-speed",c))},l=j.find("input").val(i);return h?l.change(k):j.find("button").click(function(){k.call(l);var b=a("<span>"+e("saved")+"</span>");setTimeout(function(){b.fadeOut()},1e3),a(this).after(b)}),j}},e=function(b,c){var d,e=a.extend({type:"text"},c),f=a('<input id="jsavsettings-'+b+'" type="'+e.type+'"/>');"label"in e&&(d=a('<label for="jsavsettings-'+b+'">'+e.label+"</label>")),"value"in e&&f.val(e.value);for(var g in e)-1===["label","value","type"].indexOf(g)&&f.attr(g,e[g]);return a('<div class="jsavrow"/>').append(d).append(f)},f=function(b,c){var d,e=a('<select id="jsavsettings-'+b+'" />');"label"in c&&(d=a('<label for="jsavsettings-'+b+'">'+c.label+"</label>"));var f=c.options;for(var g in f)f.hasOwnProperty(g)&&e.append('<option value="'+g+'">'+f[g]+"</option>");"value"in c&&e.val(c.value);var h=["label","value","options","type"];for(var i in c)-1===a.inArray(i,h)&&e.attr(i,c[i]);return a('<div class="jsavrow"/>').append(d).append(e)},g=function(b){this.components=[],this.add(d(this));var c=this;b&&a(b).click(function(a){a.preventDefault(),c.show()})},h=g.prototype;h.show=function(){for(var b=a("<div class='jsavsettings'></div>"),c=0;c<this.components.length;c++)b.append(this.components[c]);var d;if(this.jsav)d=this.jsav._translate;else{var e="en";window.JSAV_OPTIONS&&window.JSAV_OPTIONS.lang&&"object"==typeof JSAV._translations[window.JSAV_OPTIONS.lang]&&(e=window.JSAV_OPTIONS.lang),d=JSAV.utils.getInterpreter(JSAV._translations,e)}var f=d("settings");this.dialog=JSAV.utils.dialog(b,{title:f})},h.close=function(){this.dialog&&this.dialog.close()},h.add=function(b,c){if(!a.isFunction(b)){if(!("type"in c))return;var d,g;return g="select"===c.type?f:e,d=g(b,c),this.components.push(d),d.find("input, select")}this.components.push(b)},JSAV.utils.Settings=g,JSAV.init(function(){this.settings=this.options.settings?this.options.settings:new g(a(this.container).find(".jsavsettings").show()),this.settings.jsav=this})}}(jQuery),function(a){"use strict";var b=["correct","comment","points"],c=JSAV.utils.createUUID,d=function(b){return function(){var c="jsav"+b.id()+"ShowQuestions",d=a('<div class="jsavrow">Show Questions: <input id="'+c+'Yes" type="radio" value="true" name="jsav-questions" /><label for="'+c+'Yes">Yes</label><input  id="'+c+'No" type="radio" value="false" name="jsav-questions" /><label for="'+c+'No">No</label></div>');return b.options.showQuestions?d.find("#"+c+"Yes").prop("checked",!0):d.find("#"+c+"No").prop("checked",!0),d.find("input").on("change",function(){b.options.showQuestions="true"===a(this).val()}),d}},e=function(c,d,e){var f=a('<label for="'+e.id+'">'+c+"</label>"),g=a('<input id="'+e.id+'" type="'+d+'"/>');return a.each(e,function(a,c){-1===b.indexOf(a)&&g.attr(a,c)}),a('<div class="jsavrow"/>').append(g).append(f)},f=function(b){var c=b.find('[type="checkbox"]'),d=this,e=!0;0===c.size()&&(c=b.find('[type="radio"]'));var f,g=[];return c.each(function(b,c){var h=d.choiceById(c.id),i=a(c);f={label:h.label,selected:!!i.prop("checked"),type:i.attr("type"),correct:!0},!!i.prop("checked")!=!!h.options.correct&&(e=!1,f.correct=!1),g.push(f)}),b.filter(".jsavfeedback").html(this.jsav._translate(e?"questionCorrect":"questionIncorrect")).removeClass("jsavcorrect jsavincorrect").addClass(e?"jsavcorrect":"jsavincorrect"),b.filter('[type="submit"]').remove(),{correct:e,answers:g}},g={};g.TF={init:function(){this.name=c(),this.choices[0]=new h(this.options.falseLabel||"False","radio",{name:this.name,correct:!this.options.correct}),this.choices[1]=new h(this.options.trueLabel||"True","radio",{name:this.name,correct:!!this.options.correct}),this.correctChoice=function(a){a?this.choices[1].correct=!0:this.choices[0].correct=!0}},feedback:f},g.MC={init:function(){this.name=c()},addChoice:function(b,c){return this.choices.push(new h(b,"radio",a.extend({name:this.name},c))),this},feedback:f},g.MS={addChoice:function(b,c){return this.choices.push(new h(b,"checkbox",a.extend({},c))),this},feedback:f};var h=function(b,d,e){this.label=b,this.itemtype=d,this.options=a.extend({},e),"id"in this.options||(this.options.id=c()),this.correct=this.options.correct||!1};h.prototype.elem=function(){return e(this.label,this.itemtype,this.options)};var i=function(b,c,d,e){this.jsav=b,this.asked=!1,this.choices=[],this.questionText=d,this.maxPoints=1,this.achievedPoints=-1,this.qtype=c.toUpperCase(),this.options=e;var f=g[this.qtype],h=this;a.each(f,function(a,b){h[a]=b}),this.init()},j=i.prototype;j.id=function(a){return"undefined"==typeof a?this.id:void(this.id=a)},j.show=JSAV.anim(function(){if(!this.asked&&this.jsav._shouldAnimate()&&this.jsav.options.showQuestions){this.jsav.disableControls(),this.asked=!0;var b,c=a(),d=this;c=c.add(a('<div class="jsavfeedback" > </div>'));var e=[];for(b=this.choices.length;b--;)e.push(b);for(b=5*e.length;b--;){var f=JSAV.utils.rand.numKey(0,e.length+1),g=JSAV.utils.rand.numKey(0,e.length+1),h=e[f];e[f]=e[g],e[f]=h}for(b=0;b<this.choices.length;b++)c=c.add(this.choices[e[b]].elem());var i=a('<input type="button" value="'+this.jsav._translate("questionClose")+'" />').click(function(){d.dialog.close()});i.css("display","none"),c=c.add(i);var j=a('<input type="submit" value="'+this.jsav._translate("questionCheck")+'" />').click(function(){var a=d.feedback(c);a.question=d.questionText,a.type="jsav-question-answer",d.options.id&&(a.questionId=d.options.id),d.jsav.logEvent(a),d.jsav.options.questionResubmissionAllowed||(j.remove(),i.show())});c=c.add(j);var k=function(){var a={type:"jsav-question-close",question:d.questionText};d.jsav.enableControls(),d.options.id&&(a.questionId=d.options.id),d.jsav.logEvent(a)},l=this.jsav.options.questionDialogClass||"";this.dialog=JSAV.utils.dialog(c,{title:this.questionText,dialogRootElement:this.jsav.options.questionDialogBase,closeCallback:k,closeOnClick:!1,dialogClass:l}),this.dialog.filter(".jsavdialog").addClass("jsavquestiondialog");var m=[];for(b=0;b<this.choices.length;b++){var n=this.choices[b];m.push({label:n.label,correct:n.correct})}var o={type:"jsav-question-show",question:this.questionText,questionType:this.qtype,choices:m};return this.options.id&&(o.questionId=this.options.id),this.jsav.logEvent(o),c}}),j.choiceById=function(a){for(var b=this.choices.length;b--;)if(this.choices[b].options.id===a)return this.choices[b];return null},j.state=function(){};var k=function(){};a.each(["init","feedback","addChoice"],function(a,b){j[b]=k});var l=function(a,b,c){this.jsav=a,this.url=b,this.options=c,this._showed=!1},m=l.prototype;m._createElement=function(){var b=a("<iframe src='"+this.url+"'></iframe>");return b.prop("seamless",!0),this.options.attr&&b.attr(this.options.attr),b.addClass("jsavquestionframe"),b},m.show=JSAV.anim(function(){if(!this._showed&&this.jsav._shouldAnimate()&&this.jsav.options.showQuestions){this._showed=!0;var b=this.options.element||this._createElement(),c=a.extend({closeOnClick:!1},this.options);delete c.attr;var d=this;c.closeCallback=function(){var a={type:"jsav-question-closeiframe",question:d.questionText};d.options.id&&(a.questionId=d.options.id),d.jsav.logEvent(a)},JSAV.utils.dialog(b,c);var e={type:"jsav-question-showiframe",url:this.url};c.id&&(e.questionId=c.id),this.jsav.logEvent(e)}}),m.state=function(){},JSAV.ext.question=function(b,c,e){!this._questionSetting&&this.settings&&(this._questionSetting=!0,this.settings.add(d(this)));var f={type:"jsav-question-created",question:c};return this.logEvent(f),"IFRAME"===b?new l(this,c,e):new i(this,b,c,a.extend({},e))},JSAV.ext.resetQuestionAnswers=function(){this.begin();for(var a=0;a<this._redo.length;a++)for(var b=this._redo[a].operations,c=0;c<b.length;c++){var d=b[c].obj;d&&d instanceof i&&(d.asked=!1)}},JSAV.init(function(){"undefined"==typeof this.options.showQuestions&&(this.options.showQuestions=!0),this.container.bind({"jsav-question-reset":function(){this.resetQuestionAnswers()}.bind(this)})})}(jQuery),function(a){"use strict";if("undefined"!=typeof JSAV){var b=function(a){return a.options.grade},c=function(b,c){this.jsav=b,this.options=jQuery.extend({reset:function(){},controls:null,feedback:"atend",feedbackSelectable:!1,fixmode:"undo",fixmodeSelectable:!1,grader:"default",resetButtonTitle:this.jsav._translate("resetButtonTitle"),undoButtonTitle:this.jsav._translate("undoButtonTitle"),modelButtonTitle:this.jsav._translate("modelButtonTitle"),gradeButtonTitle:this.jsav._translate("gradeButtonTitle")},window.JSAV_EXERCISE_OPTIONS,c);var d=a(this.options.controls),e=this;0===d.size()&&(d=this.jsav.container.find(".jsavexercisecontrols"));var f=function(){e.jsav.logEvent({type:"jsav-exercise-reset"}),e.reset()},g=function(){d.addClass("active"),e.jsav.logEvent({type:"jsav-exercise-model-open"}),e.showModelanswer(),d.removeClass("active")};if(this.jsav.container.bind({"jsav-exercise-reset":f,"jsav-exercise-model":g}),d.size()){var h=a('<input type="button" name="reset" value="'+this.options.resetButtonTitle+'" />').click(f),i=a('<input type="button" name="answer" value="'+this.options.modelButtonTitle+'" />').click(g),j=a('<span class="actionIndicator"></span>');if("continuous"!==this.options.feedback){var k=a('<input type="button" name="grade" value="'+this.options.gradeButtonTitle+'" />').click(function(){d.addClass("active"),e.showGrade(),d.removeClass("active"),e.jsav.logEvent({type:"jsav-exercise-grade",score:a.extend({},e.score)})}),l=a('<input type="button" name="undo" value="'+this.options.undoButtonTitle+'" />"').click(function(){e.jsav.logEvent({type:"jsav-exercise-undo"}),e.undo()});d.append(l,h,i,k,j)}else d.append(h,i,j);j.position({of:d.children().last(),at:"right center",my:"left center",offset:"5 -2"})}this.options.feedbackSelectable&&(this.feedback=this.jsav.settings.add("feedback",{type:"select",options:{continuous:this.jsav._translate("continuous"),atend:this.jsav._translate("atend")},label:this.jsav._translate("feedbackLabel"),value:this.options.feedback})),this.options.fixmodeSelectable&&(this.fixmode=this.jsav.settings.add("fixmode",{type:"select",options:{undo:this.jsav._translate("undo"),fix:this.jsav._translate("fix")},label:this.jsav._translate("fixLabel"),value:this.options.fixmode}));var m=this.jsav.container.find(".jsavscore");1===m.size()&&0===m.children().size()&&"continuous"===this.options.feedback&&(m.html(this.jsav._translate("scoreLabel")+' <span class="jsavcurrentscore"></span> / <span class="jsavmaxscore" ></span>, <span class="jsavamidone">'+this.jsav._translate("remainingLabel")+' <span class="jsavpointsleft"></span></span>, '+this.jsav._translate("lostLabel")+' <span class="jsavpointslost" ></span>'),this._defaultscoretext=!0),this.options.showGrade&&a.isFunction(this.options.showGrade)&&(this.showGrade=this.options.showGrade);var n=this;b.gradeableStep=function(){n.gradeableStep.apply(n,arguments)}};c.GradeStepFilterFunction=b;var d=function(b,c,d){if(a.isArray(b)){d||(d=[]);for(var e=0;e<b.length;e++)if(!c[e].equals(b[e],d[e]))return!1;return!0}return c.equals(b,d)},e={"default":function(){var a=0,c=!0,e=!0,f=!0,g=this.modelav,h=this.jsav,i=g.totalSteps(),j=h.totalSteps();for(this.score.correct=0,this.score.student=0;c&&e&&f&&g.currentStep()<=i&&h.currentStep()<=j;)e=h.forward(b),f=g.forward(b),e&&a++,c=!1,f&&f&&e&&d(this.initialStructures,this.modelStructures,this.options.compare)&&(c=!0,this.score.correct++);for(e=!0;e&&h.currentStep()<j;)e=h.forward(b),e&&a++;this.score.student=a},"default-continuous":function(){var a,c=this.modelav,e=this.jsav;c.currentStep()<c.totalSteps()&&e.currentStep()<=e.totalSteps()&&(a=c.forward(b),this.score.student++,a&&d(this.initialStructures,this.modelStructures,this.options.compare)&&this.score.correct++),e.forward()},finalStep:function(){this.score.correct=0,this.score.student=1,this.score.total=1,this.modelav.end(),this.jsav.end(),d(this.initialStructures,this.modelStructures,this.options.compare)&&(this.score.correct=1)},finder:function(){var a=!0,c=!0,e=!0,f=this.modelav,g=this.jsav,h=f.totalSteps(),i=g.totalSteps();for(this.score.correct=0,this.score.student=0;e&&a&&f.currentStep()<=h&&g.currentStep()<=i;)if(e=f.forward(b)){for(c=!0;c&&!d(this.initialStructures,this.modelStructures,this.options.compare)&&g.currentStep()<=i;)c=g.forward();d(this.initialStructures,this.modelStructures,this.options.compare)?this.score.correct++:a=!1}}};e["finalStep-continuous"]=e.finalStep;var f=c.prototype;f._updateScore=function(){if("continuous"===this.options.feedback){this.modelav||(this.modelanswer(),this.grade());var a=this.jsav.container,b=this.score;this._defaultscoretext&&a.find(".jsavamidone").html(b.total===b.correct?this.jsav._translate("doneLabel"):this.jsav._translate("remainingLabel")+" <span class='jsavpointsleft'></span>");var c=b.undo;this._undoneSteps[this.jsav.currentStep()]&&(c-=1),a.find(".jsavcurrentscore").text(b.correct-c),a.find(".jsavcurrentmaxscore").text(b.correct+b.fix+b.undo),a.find(".jsavmaxscore").text(b.total),a.find(".jsavpointsleft").text(b.total-b.correct-b.fix||this.jsav._translate("doneLabel")),a.find(".jsavpointslost").text(b.fix||b.undo||0)}},f.grade=function(b){this.modelav||this.modelanswer();var c=this.jsav.currentStep(),d=this.modelav.currentStep();b||(this.jsav.begin(),this.modelav.begin());var f=a.fx.off||!1;return a.fx.off=!0,e[this.options.grader+(b?"-continuous":"")].call(this),b||(this.jsav.jumpToStep(c),this.modelav.jumpToStep(d)),a.fx.off=f,this.score
},f.showGrade=function(){this.grade();var a=this.score,b=this.jsav._translate("yourScore")+" "+a.correct+" / "+a.total;a.fix>0&&(b+="\n"+this.jsav._translate("fixedSteps")+" "+a.fix),window.alert(b)},f.modelanswer=function(c){this.modelDialog&&this.modelDialog.remove();var d,e=this.options.model,f=this,g=a.extend({title:this.jsav._translate("modelWindowTitle"),closeOnClick:!1,modal:!1,closeCallback:function(){f.jsav.logEvent({type:"jsav-exercise-model-close"}),"number"==typeof c&&d.jumpToStep(c)}},this.options.modelDialog);g.dialogClass?g.dialogClass+=" jsavmodelpreparing":g.dialogClass="jsavmodelpreparing";var h=function(b){b.av=f.jsav.id(),b.type=b.type.replace("jsav-","jsav-exercise-model-"),a("body").trigger("jsav-log-event",b)};if(a.isFunction(e)){d=new JSAV(a("<div><span class='jsavcounter'/><div class='jsavcontrols'/><p class='jsavoutput jsavline'></p></div>").addClass("jsavmodelanswer"),{logEvent:h}),d.gradeableStep=function(){this.stepOption("grade",!0),this.step()},this.modelDialog=JSAV.utils.dialog(d.container,g),this.modelStructures=e(d),d.recorded();var i=a.fx.off||!1;a.fx.off=!0;for(var j=!0,k=d.totalSteps(),l=0;j&&d.currentStep()<=k;)j=d.forward(b),j&&l++;a.fx.off=i,d.begin(),this.modelDialog.hide(),this.score.total=l,this.modelav=d}},f.showModelanswer=function(){var a=this.modelav?this.modelav.currentStep():0;this.modelanswer(a),this.modelav.begin(),this.modelDialog.removeClass("jsavmodelpreparing"),this.modelDialog.show()},f.reset=function(){this.jsav.clear(),this.score={total:0,correct:0,undo:0,fix:0,student:0},this._undoneSteps=[],this.jsav.RECORD=!0,this.initialStructures=this.options.reset(),this.jsav.displayInit(),this.jsav.recorded(),this.modelav&&(this.modelav.container.remove(),this.modelav=void 0,this.modelStructures=void 0),this.jsav._undo=[],this._updateScore(),this.jsav.logEvent({type:"jsav-exercise-init",exercise:this})},f.undo=function(){var c=a.fx.off||!1;a.fx.off=!0,this.jsav.backward(),this.jsav.backward();var d=["default","finder","finalStep"];-1!==d.indexOf(this.options.grader)&&this.jsav.backward(b)?(this.jsav.forward(),this.jsav.step()):this.jsav.begin(),this.jsav._redo=[],a.fx.off=c};var g=function(a){a.modelav.backward(),a.modelav.backward(b)&&a.modelav.forward()};f.gradeableStep=function(){var b=a.fx.off||!1;if(a.fx.off=!0,this._fixing)return void(this.options.debug&&console.error("exercise.gradeableStep() shouldn't be called in fix function"));this.jsav.stepOption("grade",!0),this.jsav.step();var c=this;if(this.feedback&&"continuous"===this.feedback.val()||!this.feedback&&"continuous"===this.options.feedback){var e=function(){var b=c.grade(!0);if(b.student===b.correct)return c.jsav.logEvent({type:"jsav-exercise-grade-change",score:a.extend({},b)}),void c._updateScore();if(b.correct!==b.total){var e=c.fixmode?c.fixmode.val():c.options.fixmode;if("none"!==e&&(c.undo(),c.score.student--),"fix"===e&&a.isFunction(c.options.fix)){c._fixing=!0;{c.modelav,c.jsav}c.fix(c.modelStructures),delete c._fixing,c.score.fix++,c.jsav.stepOption("grade",!0),c.jsav.step(),c.options.debug&&!d(c.initialStructures,c.modelStructures,c.options.compare)&&console.error("The fix function did not work as expected, the structures aren't equal"),c.jsav.logEvent({type:"jsav-exercise-step-fixed",score:a.extend({},b)}),window.alert(c.jsav._translate("fixedPopup"))}else"fix"===e?(c._undoneSteps[c.jsav.currentStep()]||(c.score.undo++,c._undoneSteps[c.jsav.currentStep()]=!0),c.jsav.logEvent({type:"jsav-exercise-step-undone",score:a.extend({},b)}),g(c),window.alert(c.jsav._translate("fixFailedPopup"))):"none"===e||(c._undoneSteps[c.jsav.currentStep()]||(c.score.undo++,c._undoneSteps[c.jsav.currentStep()]=!0),c.jsav.logEvent({type:"jsav-exercise-step-undone",score:a.extend({},b)}),g(c),window.alert(c.jsav._translate("undonePopup")));c._updateScore()}};c.jsav._clearPlaying(function(){c.jsav.logEvent({type:"jsav-exercise-gradeable-step"}),e(),a.fx.off=b})}else this.jsav._clearPlaying(function(){c.jsav.logEvent({type:"jsav-exercise-gradeable-step"})}),a.fx.off=b},f.fix=function(){var b=this.options.fix;if(a.isFunction(b)){var c=a.fx.off||!1;a.fx.off=!0,b(this.modelStructures),a.fx.off=c}},f._jsondump=function(){var b=this.jsav,c=[],d=!0,e=this.initialStructures,f=b.currentStep(),g=a.fx.off||!1;a.fx.off=!0;var h=function(){if(a.isArray(e)){for(var b=[],c=0,d=e.length;d>c;c++)b.push(e[c].state());return b}return e.state()};for(b.begin();d;)c.push(h()),d=b.forward();return this.jsav.jumpToStep(f),a.fx.off=g,JSON.stringify(c)},JSAV._types.Exercise=c,JSAV.ext.exercise=function(b,d,e){var f=a.extend({model:b,reset:d},e);return new c(this,f)}}}(jQuery),function(){"undefined"!=typeof JSAV&&(JSAV.version=function(){return"v0.7.0-258-g9416b99"})}();